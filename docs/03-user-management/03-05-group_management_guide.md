# 3.5 ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—æˆ¦ç•¥

---

## ğŸ“– å­¦ç¿’ç›®æ¨™

Microsoft 365ã«ãŠã‘ã‚‹åŠ¹ç‡çš„ãªã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†æ‰‹æ³•ã‚’ç¿’å¾—ã—ã€æ•™è‚²æ©Ÿé–¢ç‰¹æœ‰ã®çµ„ç¹”æ§‹é€ ã‚„å¹´æ¬¡æ›´æ–°ã«å¯¾å¿œã§ãã‚‹æŸ”è»Ÿã§æŒç¶šå¯èƒ½ãªã‚°ãƒ«ãƒ¼ãƒ—æˆ¦ç•¥ã‚’æ§‹ç¯‰ã§ãã‚‹ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã™ã€‚

### ğŸ¯ ã“ã®ç¯€ã§ç¿’å¾—ã™ã‚‹ã“ã¨

- **ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¨®é¡ã¨ç‰¹å¾´**ã‚’ç†è§£ã—ã€ç›®çš„ã«å¿œã˜ãŸé©åˆ‡ãªé¸æŠãŒã§ãã‚‹
- **é™çš„ãƒ»å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—**ã®ä»•çµ„ã¿ã‚’ç†è§£ã—ã€çµ„ç¹”ã«é©ã—ãŸç®¡ç†æ–¹å¼ã‚’è¨­è¨ˆã§ãã‚‹
- **æ•™è‚²æ©Ÿé–¢å‘ã‘ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**ã‚’ç¿’å¾—ã—ã€å­¦æ ¡é‹ç”¨ã«æœ€é©åŒ–ã•ã‚ŒãŸã‚°ãƒ«ãƒ¼ãƒ—æˆ¦ç•¥ã‚’å®Ÿè·µã§ãã‚‹
- **å¹´æ¬¡æ›´æ–°ã®è‡ªå‹•åŒ–**æŠ€è¡“ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã€æ–°å¹´åº¦å¯¾å¿œã®è² è·ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã‚‹
- **School Data Sync (SDS)**ã‚’æ´»ç”¨ã—ã€æ ¡å‹™æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºã‚’å®Ÿç¾ã§ãã‚‹

### ğŸ’¼ å®Ÿå‹™ã§ã®æ´»ç”¨å ´é¢

- **æ–°å¹´åº¦æº–å‚™**: å­¦å¹´ãƒ»ã‚¯ãƒ©ã‚¹ãƒ»éƒ¨æ´»å‹•ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€æ‹¬æ›´æ–°ã¨è‡ªå‹•åŒ–
- **çµ„ç¹”å¤‰æ›´å¯¾å¿œ**: æ•™è·å“¡ã®ç•°å‹•ãƒ»æ˜‡æ ¼ã«ä¼´ã†ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®å‹•çš„ç®¡ç†
- **ã‚¢ã‚¯ã‚»ã‚¹æ¨©ç®¡ç†**: æ•™æãƒ»è³‡æ–™ã¸ã®é©åˆ‡ãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºä¿
- **ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¿ƒé€²**: å­¦éƒ¨ãƒ»å­¦ç§‘æ¨ªæ–­çš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã®åŠ¹ç‡çš„ãªé‹å–¶
- **ã‚·ã‚¹ãƒ†ãƒ é€£æº**: æ ¡å‹™æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ãƒ»å­¦ç¿’ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆLMSï¼‰ã¨ã®è‡ªå‹•åŒæœŸ

---

## âš¡ å‰ææ¡ä»¶

### å¿…è¦ãªæ¨©é™ãƒ»ç’°å¢ƒ

- [ ] **Microsoft 365ãƒ†ãƒŠãƒ³ãƒˆ**ï¼ˆæ•™è‚²æ©Ÿé–¢å‘ã‘A1/A3/A5ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼‰
- [ ] **ã‚°ãƒ­ãƒ¼ãƒãƒ«ç®¡ç†è€…**ã¾ãŸã¯**ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†è€…**æ¨©é™
- [ ] **Microsoft Entra IDç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼**ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©
- [ ] **PowerShell 7.x + Microsoft Graph PowerShell SDK**
- [ ] **Microsoft 365 A3/A5ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**ï¼ˆå‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½¿ç”¨æ™‚ï¼‰

### äº‹å‰æº–å‚™

```markdown
ğŸ“‹ ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†æº–å‚™ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ç¾åœ¨ã®çµ„ç¹”æ§‹é€ ãƒ»è·åˆ¶ã®æ•´ç†
- [ ] æ—¢å­˜ã‚°ãƒ«ãƒ¼ãƒ—ã®æ£šå¸ã—ã¨åˆ†é¡
- [ ] å¹´æ¬¡æ›´æ–°ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æï¼ˆå­¦å¹´ãƒ»ã‚¯ãƒ©ã‚¹ãƒ»éƒ¨æ´»å‹•ç­‰ï¼‰
- [ ] æ ¡å‹™æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºè¦ä»¶ç¢ºèª
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã¨ã‚¢ã‚¯ã‚»ã‚¹æ¨©è¦ä»¶ã®æ˜ç¢ºåŒ–
- [ ] å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼ˆMicrosoft 365 A3/A5ï¼‰ã®ç¢ºèª
```

> ğŸ’¡ **é‡è¦**: æ•™è‚²æ©Ÿé–¢ã§ã¯å¹´åº¦å˜ä½ã§ã®å¤§è¦æ¨¡ãªçµ„ç¹”å¤‰æ›´ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã§è‡ªå‹•åŒ–å¯èƒ½ãªã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆãŒæˆåŠŸã®éµã¨ãªã‚Šã¾ã™ã€‚

---

## ğŸ” Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¨®é¡ã¨ç‰¹å¾´

### 1. Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆæ—§Office 365ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰

**ç›®çš„**: ç¤¾å†…å¤–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§ã®å…±åŒä½œæ¥­ã«ä½¿ç”¨ã•ã‚Œã€ãƒãƒ¼ãƒ ã®å…±åŒä½œæ¥­ã‚’ã‚ˆã‚ŠåŠ¹ç‡çš„ã«è¡Œã†ã®ã«å½¹ç«‹ã¤ã‚°ãƒ«ãƒ¼ãƒ—ã§ã™ã€‚å„ã‚°ãƒ«ãƒ¼ãƒ—ã§ã¯ã€ãƒ¡ãƒ³ãƒãƒ¼ã¯ã€ä¼šè©±ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€äºˆå®šè¡¨ã‚¤ãƒ™ãƒ³ãƒˆã€Streamã€Planner ã®ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ¼ãƒ«ã¨å…±æœ‰ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’å–å¾—ã—ã¾ã™

#### ä¸»ãªç‰¹å¾´

| é …ç›® | è©³ç´° |
|------|------|
| **ä»˜å±ã‚µãƒ¼ãƒ“ã‚¹** | Exchange Onlineï¼ˆãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ï¼‰ã€SharePoint ã‚µã‚¤ãƒˆã€OneNoteã€Plannerã€Teams |
| **ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** | ãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰ã€å…±åŒç·¨é›†ã€ãƒãƒ£ãƒƒãƒˆã€ãƒ“ãƒ‡ã‚ªä¼šè­° |
| **å¤–éƒ¨é€£æº** | ç®¡ç†è€…ã«ã‚ˆã£ã¦æœ‰åŠ¹ã«ã•ã‚Œã¦ã„ã‚‹é™ã‚Šã€çµ„ç¹”ã®å¤–éƒ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ ã§ãã¾ã™ |
| **è‡ªå‹•åŒ–é€£æº** | Teamsã€SharePointã€Plannerã€Stream ã®è‡ªå‹•ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° |
| **ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—** | é™çš„ãƒ»å‹•çš„ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆ |

#### æ•™è‚²æ©Ÿé–¢ã§ã®æ´»ç”¨ä¾‹

```markdown
ğŸ“ å­¦æ ¡ã§ã®æ´»ç”¨ã‚·ãƒŠãƒªã‚ª
- **å­¦å¹´ãƒ»ã‚¯ãƒ©ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—**: "2025å¹´åº¦-1å¹´Açµ„" â†’ Teamsæˆæ¥­ã€è³‡æ–™å…±æœ‰
- **éƒ¨æ´»å‹•ãƒ»ã‚µãƒ¼ã‚¯ãƒ«**: "é‡çƒéƒ¨2025" â†’ æ´»å‹•è¨˜éŒ²ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†
- **æ•™ç§‘ãƒ»å°‚æ”»ã‚°ãƒ«ãƒ¼ãƒ—**: "æ•°å­¦ç§‘æ•™å“¡" â†’ æ•™æé–‹ç™ºã€æƒ…å ±å…±æœ‰
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ãƒ **: "æ–‡åŒ–ç¥­å®Ÿè¡Œå§”å“¡ä¼š" â†’ ä¼ç”»ãƒ»æº–å‚™ã®å”åƒä½œæ¥­
- **PTAãƒ»ä¿è­·è€…ä¼š**: "1å¹´ç”Ÿä¿è­·è€…ä¼š" â†’ é€£çµ¡ãƒ»ç›¸è«‡ã€ã‚¤ãƒ™ãƒ³ãƒˆèª¿æ•´
```

### 2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—

**ç›®çš„**: SharePoint ã‚µã‚¤ãƒˆãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã€ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ä¸€å…ƒç®¡ç†ã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã¾ã™

#### ä¸»ãªç‰¹å¾´

| é …ç›® | è©³ç´° |
|------|------|
| **ä¸»è¦æ©Ÿèƒ½** | ãƒªã‚½ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ç®¡ç†ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰²ã‚Šå½“ã¦ |
| **é©ç”¨ç¯„å›²** | SharePointã€Teamsã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ |
| **ãƒ¡ãƒ³ãƒãƒ¼ç¨®åˆ¥** | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ãƒ‡ãƒã‚¤ã‚¹ã€ãƒã‚¹ãƒˆã—ãŸã‚°ãƒ«ãƒ¼ãƒ— |
| **ãƒ¡ãƒ¼ãƒ«æ©Ÿèƒ½** | ãªã—ï¼ˆãƒ¡ãƒ¼ãƒ«æœ‰åŠ¹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã¯åˆ¥é€”ï¼‰ |
| **ç®¡ç†å ´æ‰€** | Microsoft Entra IDã€Microsoft 365ç®¡ç†ã‚»ãƒ³ã‚¿ãƒ¼ |

#### æ•™è‚²æ©Ÿé–¢ã§ã®æ´»ç”¨ä¾‹

```markdown
ğŸ« å­¦æ ¡ã§ã®æ¨©é™ç®¡ç†ã‚·ãƒŠãƒªã‚ª
- **è·ç¨®åˆ¥ã‚¢ã‚¯ã‚»ã‚¹**: "Teachers" â†’ æˆç¸¾ã‚·ã‚¹ãƒ†ãƒ ã€æ•™æãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **å­¦å¹´åˆ¥æ¨©é™**: "Grade1-Students" â†’ å­¦å¹´é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„
- **ç®¡ç†è·æ¨©é™**: "SchoolAdmins" â†’ äººäº‹æƒ…å ±ã€äºˆç®—ãƒ‡ãƒ¼ã‚¿
- **æ–½è¨­åˆ©ç”¨æ¨©**: "LabUsers" â†’ ç‰¹å®šPCæ•™å®¤ã€å®Ÿé¨“å®¤ã‚·ã‚¹ãƒ†ãƒ 
- **å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹**: "GuestLecturers" â†’ é™å®šçš„ãªã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚»ã‚¹
```

### 3. é…å¸ƒã‚°ãƒ«ãƒ¼ãƒ—

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«é€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹ã®ã«ä½¿ç”¨ã•ã‚Œã¾ã™

#### ç‰¹å¾´ã¨æ´»ç”¨å ´é¢

```markdown
ğŸ“§ é…å¸ƒã‚°ãƒ«ãƒ¼ãƒ—ã®ç‰¹å¾´
- ãƒ¡ãƒ¼ãƒ«é…ä¿¡å°‚ç”¨ï¼ˆSharePointç­‰ã¨ã®é€£æºãªã—ï¼‰
- å¤–éƒ¨ãƒ¡ãƒ¼ãƒ«å—ä¿¡å¯èƒ½ï¼ˆç®¡ç†è€…è¨­å®šã«ã‚ˆã‚Šï¼‰
- è»½é‡ã§ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ 
- Microsoft Teams ã®ãƒ¡ãƒ³ãƒãƒ¼ã«è¿½åŠ å¯èƒ½ï¼ˆå€‹åˆ¥ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦ï¼‰

ğŸ¯ æ•™è‚²æ©Ÿé–¢ã§ã®æ´»ç”¨
- å…¨æ ¡é€šçŸ¥: "all-staff@school.edu.jp"
- å­¦å¹´åˆ¥é€£çµ¡: "grade1-parents@school.edu.jp" 
- éƒ¨é–€åˆ¥é€šçŸ¥: "science-dept@school.edu.jp"
- ç·Šæ€¥é€£çµ¡ç¶²: "emergency-contacts@school.edu.jp"
```

### 4. ãƒ¡ãƒ¼ãƒ«æœ‰åŠ¹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—

**ç›®çš„**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã¨é…å¸ƒãƒªã‚¹ãƒˆã®æ©Ÿèƒ½ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®ã§ã€ãƒ¡ãƒ³ãƒãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’è¡Œã„ãªãŒã‚‰ã€ãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡ã‚‚å¯èƒ½ã§ã™

#### æ´»ç”¨ã‚·ãƒŠãƒªã‚ª

```markdown
ğŸ” çµ±åˆå‹ã‚°ãƒ«ãƒ¼ãƒ—æ´»ç”¨ä¾‹
- "ITSupport" â†’ ã‚·ã‚¹ãƒ†ãƒ æ¨©é™ + ITé–¢é€£é€šçŸ¥å—ä¿¡
- "GradeCoordinators" â†’ å­¦å¹´ç®¡ç†æ¨©é™ + ä¿è­·è€…é€£çµ¡
- "LabManagers" â†’ å®Ÿé¨“å®¤ã‚¢ã‚¯ã‚»ã‚¹ + æ©Ÿå™¨ç®¡ç†é€šçŸ¥
- "EventOrganizers" â†’ ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†æ¨©é™ + é–¢ä¿‚è€…é€£çµ¡
```

---

## ğŸ“Š é™çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ— vs å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—

### é™çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—

#### ç‰¹å¾´

- **æ‰‹å‹•ç®¡ç†**: ç®¡ç†è€…ãŒå€‹åˆ¥ã«ãƒ¡ãƒ³ãƒãƒ¼ã‚’è¿½åŠ ãƒ»å‰Šé™¤
- **å³æ™‚åæ˜ **: å¤‰æ›´ãŒç›´ã¡ã«ã‚°ãƒ«ãƒ¼ãƒ—ã«åæ˜ 
- **ç´°ã‹ã„åˆ¶å¾¡**: ä¾‹å¤–çš„ãªãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã«ã‚‚å¯¾å¿œå¯èƒ½
- **ã‚·ãƒ³ãƒ—ãƒ«**: è¿½åŠ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¸è¦ã€è¨­å®šãŒç°¡å˜

#### é©ç”¨å ´é¢

```markdown
ğŸ¯ é™çš„ã‚°ãƒ«ãƒ¼ãƒ—ãŒé©ã—ã¦ã„ã‚‹å ´é¢
- äººæ•°ãŒå°‘ãªãå¤‰å‹•é »åº¦ã®ä½ã„ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆç®¡ç†è·ã€å§”å“¡ä¼šç­‰ï¼‰
- ä¾‹å¤–çš„ãªãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãŒå¿…è¦ï¼ˆç‰¹åˆ¥è¬›å¸«ã€éå¸¸å‹¤ç­‰ï¼‰
- ä¸€æ™‚çš„ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆæ–‡åŒ–ç¥­å®Ÿè¡Œå§”å“¡ä¼šç­‰ï¼‰
- ç´°ã‹ã„ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãŒå¿…è¦ãªå ´åˆ
```

### å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—

#### ç‰¹å¾´ã¨è¦ä»¶

- **è‡ªå‹•ç®¡ç†**: éƒ¨é–€ã€å ´æ‰€ã€ã‚¿ã‚¤ãƒˆãƒ«ãªã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ã«åŸºã¥ã„ã¦ã‚°ãƒ«ãƒ¼ãƒ— ãƒ¡ãƒ³ãƒãƒ¼ã‚’è‡ªå‹•çš„ã«è¿½åŠ ã¾ãŸã¯å‰Šé™¤ã§ãã¾ã™
- **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è¦ä»¶**: **Microsoft 365 A3, A5** (Microsoft Entra ID Premium P1ã‚’å«ã‚€) ã§åˆ©ç”¨å¯èƒ½ã€‚æ•™è‚²æ©Ÿé–¢å‘ã‘ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§ã®å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½
- **ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹**: å±æ€§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«åŸºã¥ãè‡ªå‹•ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«**: å¤§è¦æ¨¡çµ„ç¹”ã§ã®åŠ¹ç‡çš„ãªç®¡ç†

> ğŸ’¡ **æ•™è‚²æ©Ÿé–¢å‘ã‘ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**: Microsoft 365 A1ã§ã¯å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚A3ã¾ãŸã¯A5ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒå¿…è¦ã§ã™ã€‚Microsoft Entra ID Premium P1ãŒå«ã¾ã‚Œã‚‹Enterpriseç³»ãƒ—ãƒ©ãƒ³ï¼ˆE3ã€E5ï¼‰ã§ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

#### æ•™è‚²æ©Ÿé–¢ã§ã®å‹•çš„ãƒ«ãƒ¼ãƒ«ä¾‹

**ğŸ¯ å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ãƒ«ãƒ¼ãƒ«è¨­è¨ˆä¾‹**

**å­¦å¹´åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—**
```powershell
# 1å¹´ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ã®å‹•çš„ãƒ«ãƒ¼ãƒ«
(user.extensionAttribute1 -eq "Grade1") -and (user.userType -eq "Member")

# æ•™è·å“¡ã‚°ãƒ«ãƒ¼ãƒ—ã®å‹•çš„ãƒ«ãƒ¼ãƒ«  
(user.jobTitle -contains "æ•™å“¡") -or (user.jobTitle -contains "æ•™æˆ") -or (user.jobTitle -contains "è¬›å¸«")

# ç‰¹å®šå­¦éƒ¨ã®å­¦ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—
(user.department -eq "æƒ…å ±å­¦éƒ¨") -and (user.extensionAttribute2 -eq "Student")
```

**éƒ¨ç½²ãƒ»è·ç¨®åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—**
```powershell
# æ•°å­¦ç§‘æ•™å“¡ã‚°ãƒ«ãƒ¼ãƒ—
(user.department -eq "æ•°å­¦ç§‘") -and (user.jobTitle -contains "æ•™å“¡")

# ç®¡ç†è·ã‚°ãƒ«ãƒ¼ãƒ—
(user.jobTitle -contains "æ ¡é•·") -or (user.jobTitle -contains "æ•™é ­") -or (user.jobTitle -contains "ä¸»ä»»")

# éå¸¸å‹¤è¬›å¸«ã‚°ãƒ«ãƒ¼ãƒ—
(user.employeeType -eq "PartTime") -and (user.jobTitle -contains "è¬›å¸«")
```

### PowerShellã«ã‚ˆã‚‹å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
æ•™è‚²æ©Ÿé–¢ã®çµ„ç¹”æ§‹é€ ã«åŸºã¥ã„ãŸå‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’åŠ¹ç‡çš„ã«ä½œæˆã—ã€å±æ€§ãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ã‚’å®Ÿç¾ã—ã¾ã™ã€‚å­¦å¹´ã€å­¦ç§‘ã€è·ç¨®ãªã©ã®å±æ€§ã‚’æ´»ç”¨ã—ã¦ã€å¹´æ¬¡æ›´æ–°æ™‚ã®æ‰‹å‹•ä½œæ¥­ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªå‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
New-DynamicEducationGroup -GroupName "2025å¹´åº¦-1å¹´ç”Ÿ" -Rule "(user.extensionAttribute1 -eq 'Grade1')" -GroupType "Security"

# è¤‡åˆæ¡ä»¶ã§ã®å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—
New-DynamicEducationGroup -GroupName "æ•°å­¦ç§‘æ•™å“¡" -Rule "(user.department -eq 'æ•°å­¦ç§‘') -and (user.jobTitle -contains 'æ•™å“¡')" -GroupType "Microsoft365"

# ä¸€æ‹¬ä½œæˆï¼ˆCSVå…¥åŠ›ï¼‰
$groups = Import-Csv "C:\temp\dynamic_groups.csv"
$groups | ForEach-Object { New-DynamicEducationGroup -GroupName $_.GroupName -Rule $_.Rule -GroupType $_.GroupType }
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-GroupName`: ä½œæˆã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—å
- `-Rule`: å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ«ãƒ¼ãƒ«ï¼ˆAzure AD Queryæ§‹æ–‡ï¼‰
- `-GroupType`: ã‚°ãƒ«ãƒ¼ãƒ—ç¨®åˆ¥ï¼ˆSecurity/Microsoft365ï¼‰
- `-Description`: ã‚°ãƒ«ãƒ¼ãƒ—ã®èª¬æ˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```powershell
function New-DynamicEducationGroup {
    param(
        [Parameter(Mandatory=$true)]
        [string]$GroupName,
        
        [Parameter(Mandatory=$true)]
        [string]$Rule,
        
        [Parameter(Mandatory=$true)]
        [ValidateSet("Security", "Microsoft365")]
        [string]$GroupType,
        
        [string]$Description = ""
    )
    
    try {
        Write-Host "å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆä¸­: $GroupName" -ForegroundColor Cyan
        
        # ã‚°ãƒ«ãƒ¼ãƒ—ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
        $groupParams = @{
            DisplayName = $GroupName
            Description = if ($Description) { $Description } else { "å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—: $GroupName" }
            GroupTypes = @("DynamicMembership")
            MembershipRule = $Rule
            MembershipRuleProcessingState = "On"
        }
        
        if ($GroupType -eq "Microsoft365") {
            $groupParams.GroupTypes += "Unified"
            $groupParams.MailEnabled = $true
            $groupParams.MailNickname = ($GroupName -replace '[^a-zA-Z0-9]', '').ToLower()
        } else {
            $groupParams.SecurityEnabled = $true
        }
        
        # ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ
        $newGroup = New-MgGroup @groupParams
        
        Write-Host "âœ… å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆå®Œäº†" -ForegroundColor Green
        Write-Host "  ã‚°ãƒ«ãƒ¼ãƒ—å: $($newGroup.DisplayName)" -ForegroundColor White
        Write-Host "  ã‚°ãƒ«ãƒ¼ãƒ—ID: $($newGroup.Id)" -ForegroundColor White
        Write-Host "  ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ«ãƒ¼ãƒ«: $Rule" -ForegroundColor Yellow
        
        # å‹•çš„ãƒ«ãƒ¼ãƒ«å‡¦ç†çŠ¶æ³ã®ç¢ºèª
        Write-Host "â³ å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—å‡¦ç†ä¸­..." -ForegroundColor Yellow
        Write-Host "   â€» å±æ€§ã«åŸºã¥ããƒ¡ãƒ³ãƒãƒ¼è¿½åŠ ã«ã¯æ•°åˆ†ã€œæ•°æ™‚é–“ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™" -ForegroundColor Gray
        Write-Host "   â€» Microsoft 365 A3/A5ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒå¿…è¦ã§ã™" -ForegroundColor Yellow
        
        return $newGroup
        
    } catch {
        Write-Error "å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆå¤±æ•—: $GroupName - $($_.Exception.Message)"
        
        # ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã®è¨ºæ–­ãƒ’ãƒ³ãƒˆ
        if ($_.Exception.Message -like "*Premium*") {
            Write-Warning "Microsoft 365 A3/A5 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼ˆMicrosoft Entra ID Premium P1ã‚’å«ã‚€ï¼‰ãŒå¿…è¦ã§ã™"
        } elseif ($_.Exception.Message -like "*syntax*") {
            Write-Warning "ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ«ãƒ¼ãƒ«ã®æ§‹æ–‡ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
        }
    }
}

# å‹•çš„ãƒ«ãƒ¼ãƒ«ã®æ¤œè¨¼ç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
function Test-DynamicMembershipRule {
    param(
        [string]$Rule,
        [string]$TestUserPrincipalName
    )
    
    try {
        # ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å±æ€§å–å¾—
        $testUser = Get-MgUser -Filter "userPrincipalName eq '$TestUserPrincipalName'" -Property "id,userPrincipalName,department,jobTitle,extensionAttribute1,extensionAttribute2,userType,employeeType"
        
        if (-not $testUser) {
            Write-Warning "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $TestUserPrincipalName"
            return
        }
        
        Write-Host "=== å‹•çš„ãƒ«ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ ===" -ForegroundColor Magenta
        Write-Host "ãƒ«ãƒ¼ãƒ«: $Rule" -ForegroundColor Yellow
        Write-Host "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼: $TestUserPrincipalName" -ForegroundColor Cyan
        
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ã®è¡¨ç¤º
        Write-Host "`nãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§:" -ForegroundColor Green
        $testUser | Select-Object userPrincipalName, department, jobTitle, extensionAttribute1, extensionAttribute2, userType, employeeType | Format-List
        
        # å®Ÿéš›ã®å‹•çš„ãƒ«ãƒ¼ãƒ«è©•ä¾¡ï¼ˆGraph APIã‚’ä½¿ç”¨ï¼‰
        # â€» å®Ÿéš›ã®è©•ä¾¡ã¯Microsoft Entra IDãŒè¡Œã†ãŸã‚ã€ã“ã“ã§ã¯å±æ€§ã®ç¢ºèªã®ã¿
        Write-Host "âš ï¸ å®Ÿéš›ã®è©•ä¾¡çµæœã¯ Microsoft Entra ID ã®å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½ã«ã‚ˆã£ã¦å‡¦ç†ã•ã‚Œã¾ã™" -ForegroundColor Yellow
        
    } catch {
        Write-Error "å‹•çš„ãƒ«ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆå¤±æ•—: $($_.Exception.Message)"
    }
}
```

---

## ğŸ« æ•™è‚²æ©Ÿé–¢å‘ã‘ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. éšå±¤çš„ã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆ

#### æ¨™æº–çš„ãªå­¦æ ¡çµ„ç¹”ã«å¯¾å¿œã—ãŸã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ 

```markdown
ğŸ“Š æ¨å¥¨ã‚°ãƒ«ãƒ¼ãƒ—éšå±¤æ§‹é€ 

ğŸ« å­¦æ ¡å…¨ä½“ãƒ¬ãƒ™ãƒ«
â”œâ”€â”€ ğŸ¯ å…¨æ•™è·å“¡ï¼ˆAll-Staffï¼‰
â”œâ”€â”€ ğŸ“ å…¨å­¦ç”Ÿï¼ˆAll-Studentsï¼‰
â”œâ”€â”€ ğŸ‘¨â€ğŸ’¼ ç®¡ç†è·ï¼ˆAdministratorsï¼‰
â””â”€â”€ ğŸ¢ äº‹å‹™è·å“¡ï¼ˆAdministrative-Staffï¼‰

ğŸ›ï¸ éƒ¨é–€ãƒ»å­¦ç§‘ãƒ¬ãƒ™ãƒ«
â”œâ”€â”€ ğŸ“š å„å­¦ç§‘æ•™å“¡ã‚°ãƒ«ãƒ¼ãƒ—
â”‚   â”œâ”€â”€ æ•°å­¦ç§‘æ•™å“¡ï¼ˆMath-Facultyï¼‰
â”‚   â”œâ”€â”€ å›½èªç§‘æ•™å“¡ï¼ˆJapanese-Facultyï¼‰
â”‚   â””â”€â”€ ç†ç§‘æ•™å“¡ï¼ˆScience-Facultyï¼‰
â”œâ”€â”€ ğŸ¯ å­¦å¹´ä¸»ä»»ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆGrade-Coordinatorsï¼‰
â””â”€â”€ ğŸƒâ€â™‚ï¸ éƒ¨æ´»å‹•é¡§å•ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆClub-Advisorsï¼‰

ğŸ“ å­¦å¹´ãƒ»ã‚¯ãƒ©ã‚¹ãƒ¬ãƒ™ãƒ«  
â”œâ”€â”€ ğŸ“– å­¦å¹´åˆ¥å­¦ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—
â”‚   â”œâ”€â”€ 2025å¹´åº¦-1å¹´ç”Ÿï¼ˆGrade1-2025ï¼‰
â”‚   â”œâ”€â”€ 2025å¹´åº¦-2å¹´ç”Ÿï¼ˆGrade2-2025ï¼‰ 
â”‚   â””â”€â”€ 2025å¹´åº¦-3å¹´ç”Ÿï¼ˆGrade3-2025ï¼‰
â”œâ”€â”€ ğŸ›ï¸ ã‚¯ãƒ©ã‚¹åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—
â”‚   â”œâ”€â”€ 1å¹´Açµ„ï¼ˆClass-1A-2025ï¼‰
â”‚   â””â”€â”€ 1å¹´Bçµ„ï¼ˆClass-1B-2025ï¼‰
â””â”€â”€ ğŸƒâ€â™‚ï¸ éƒ¨æ´»å‹•ãƒ»ã‚µãƒ¼ã‚¯ãƒ«ï¼ˆClub-Baseball-2025ï¼‰

ğŸ¯ æ©Ÿèƒ½åˆ¥ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«
â”œâ”€â”€ ğŸ’» ITå§”å“¡ä¼šï¼ˆIT-Committeeï¼‰
â”œâ”€â”€ ğŸª æ–‡åŒ–ç¥­å®Ÿè¡Œå§”å“¡ä¼šï¼ˆFestival-Committeeï¼‰
â”œâ”€â”€ ğŸ“ å…¥è©¦å§”å“¡ä¼šï¼ˆAdmission-Committeeï¼‰
â””â”€â”€ ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†è€…ï¼ˆSecurity-Adminsï¼‰
```

### 2. å‘½åè¦å‰‡ã®æ¨™æº–åŒ–

#### ä½“ç³»çš„ãªã‚°ãƒ«ãƒ¼ãƒ—å‘½åãƒ«ãƒ¼ãƒ«

```markdown
ğŸ“ æ¨å¥¨å‘½åè¦å‰‡

**åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³**: [ç¨®åˆ¥]-[å¯¾è±¡]-[å¹´åº¦/æœŸé–“]

**ç¨®åˆ¥ã‚³ãƒ¼ãƒ‰**:
- STAFF: æ•™è·å“¡é–¢é€£
- STU: å­¦ç”Ÿé–¢é€£  
- CLUB: éƒ¨æ´»å‹•ãƒ»ã‚µãƒ¼ã‚¯ãƒ«
- PROJ: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»å§”å“¡ä¼š
- SYS: ã‚·ã‚¹ãƒ†ãƒ ãƒ»ç®¡ç†ç”¨

**å¯¾è±¡è­˜åˆ¥å­**:
- å­¦å¹´: Grade1, Grade2, Grade3
- å­¦ç§‘: Math, Science, English, etc.
- è·ç¨®: Teacher, Admin, Librarian
- ã‚¯ãƒ©ã‚¹: ClassA, ClassB, ClassC

**å¹´åº¦è¡¨è¨˜**: 2025, 2026ï¼ˆè¥¿æš¦å¹´ï¼‰

**å…·ä½“ä¾‹**:
- STU-Grade1-2025ï¼ˆ2025å¹´åº¦1å¹´ç”Ÿï¼‰
- STAFF-Math-ALLï¼ˆæ•°å­¦ç§‘å…¨æ•™å“¡ï¼‰
- CLUB-Baseball-2025ï¼ˆé‡çƒéƒ¨2025å¹´åº¦ï¼‰
- PROJ-Festival-2025ï¼ˆæ–‡åŒ–ç¥­å®Ÿè¡Œå§”å“¡ä¼šï¼‰
- SYS-ITAdmin-ALLï¼ˆITç®¡ç†è€…ï¼‰
```

### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

#### æ•™è‚²æ©Ÿé–¢ç‰¹æœ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

**ğŸ”’ ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**

```markdown
ğŸ›¡ï¸ å¤šå±¤é˜²å¾¡ã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

**ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**
- å…¨å­¦ç”Ÿ â†’ åŸºæœ¬çš„ãªæ•™è‚²ãƒªã‚½ãƒ¼ã‚¹
- å…¨æ•™è·å“¡ â†’ æ ¡å‹™ã‚·ã‚¹ãƒ†ãƒ ã€æ•™æãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- ä¸€èˆ¬äº‹å‹™ â†’ äº‹å‹™ã‚·ã‚¹ãƒ†ãƒ ã€åŸºæœ¬æƒ…å ±

**ãƒ¬ãƒ™ãƒ«2: æ©Ÿèƒ½åˆ¥ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**  
- å­¦å¹´æ‹…å½“ â†’ æ‹…å½“å­¦å¹´ã®æˆç¸¾ãƒ»å‡ºå¸­æƒ…å ±
- æ•™ç§‘æ‹…å½“ â†’ è©²å½“æ•™ç§‘ã®æ•™æãƒ»è©•ä¾¡ãƒ‡ãƒ¼ã‚¿
- éƒ¨æ´»é¡§å• â†’ éƒ¨æ´»å‹•é–¢é€£æƒ…å ±ãƒ»æ–½è¨­äºˆç´„

**ãƒ¬ãƒ™ãƒ«3: ç®¡ç†è€…ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**
- ITç®¡ç†è€… â†’ ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- æ•™å‹™ä¸»ä»» â†’ å…¨æ ¡ã®æ•™å‹™æƒ…å ±ã€æ™‚é–“å‰²
- æ ¡é•·ãƒ»æ•™é ­ â†’ äººäº‹ãƒ»äºˆç®—ãƒ»æ©Ÿå¯†æƒ…å ±

**ãƒ¬ãƒ™ãƒ«4: æ©Ÿå¯†ãƒ»ç‰¹æ¨©ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**
- äººäº‹æ‹…å½“ â†’ äººäº‹ãƒ»çµ¦ä¸ãƒ»è©•ä¾¡æƒ…å ±
- çµŒç†æ‹…å½“ â†’ äºˆç®—ãƒ»è²¡å‹™ãƒ»å¥‘ç´„æƒ…å ±
- ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€… â†’ å…¨ã‚·ã‚¹ãƒ†ãƒ ç‰¹æ¨©ã‚¢ã‚¯ã‚»ã‚¹
```

#### æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ã¨ã®é€£æº

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
æ•™è‚²æ©Ÿé–¢å‘ã‘ã®æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’é€£æºã•ã›ã€å ´æ‰€ãƒ»æ™‚é–“ãƒ»ãƒ‡ãƒã‚¤ã‚¹ã«åŸºã¥ãæŸ”è»Ÿãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å®Ÿç¾ã—ã¾ã™ã€‚æ ¡å†…ãƒ»æ ¡å¤–ã€æˆæ¥­æ™‚é–“ãƒ»æ”¾èª²å¾Œãªã©ã®æ¡ä»¶ã«å¿œã˜ãŸé©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ™ãƒ«ã‚’è‡ªå‹•çš„ã«é©ç”¨ã§ãã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼é©ç”¨
Set-EducationSecurityPolicy -GroupName "Students-Grade1" -AccessLevel "Standard" -RequireMFA $false

# é«˜ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ï¼ˆç®¡ç†è€…å‘ã‘ï¼‰
Set-EducationSecurityPolicy -GroupName "IT-Administrators" -AccessLevel "High" -RequireMFA $true -RestrictLocation $true

# æ™‚é–“åˆ¶é™ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ï¼ˆéƒ¨æ´»å‹•å‘ã‘ï¼‰
Set-EducationSecurityPolicy -GroupName "Club-Activities" -AccessLevel "Limited" -TimeRestriction "AfterSchool"
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-GroupName`: å¯¾è±¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—å
- `-AccessLevel`: ã‚¢ã‚¯ã‚»ã‚¹ãƒ¬ãƒ™ãƒ«ï¼ˆStandard/High/Limitedï¼‰
- `-RequireMFA`: å¤šè¦ç´ èªè¨¼è¦æ±‚ã®æœ‰ç„¡
- `-RestrictLocation`: å ´æ‰€åˆ¶é™ã®æœ‰ç„¡
- `-TimeRestriction`: æ™‚é–“åˆ¶é™ï¼ˆSchoolHours/AfterSchool/AllTimeï¼‰

```powershell
function Set-EducationSecurityPolicy {
    param(
        [Parameter(Mandatory=$true)]
        [string]$GroupName,
        
        [Parameter(Mandatory=$true)]
        [ValidateSet("Standard", "High", "Limited")]
        [string]$AccessLevel,
        
        [bool]$RequireMFA = $true,
        [bool]$RestrictLocation = $false,
        
        [ValidateSet("SchoolHours", "AfterSchool", "AllTime")]
        [string]$TimeRestriction = "AllTime"
    )
    
    try {
        # å¯¾è±¡ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¢ºèª
        $targetGroup = Get-MgGroup -Filter "displayName eq '$GroupName'"
        if (-not $targetGroup) {
            Write-Error "ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $GroupName"
            return
        }
        
        Write-Host "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼è¨­å®šä¸­: $GroupName" -ForegroundColor Cyan
        
        # ã‚¢ã‚¯ã‚»ã‚¹ãƒ¬ãƒ™ãƒ«åˆ¥è¨­å®š
        $policySettings = switch ($AccessLevel) {
            "Standard" {
                @{
                    SignInRiskLevel = "medium"
                    UserRiskLevel = "medium"
                    RequireCompliantDevice = $false
                    RequireApprovedClientApp = $true
                }
            }
            "High" {
                @{
                    SignInRiskLevel = "low"
                    UserRiskLevel = "low"
                    RequireCompliantDevice = $true
                    RequireApprovedClientApp = $true
                }
            }
            "Limited" {
                @{
                    SignInRiskLevel = "high"
                    UserRiskLevel = "high"
                    RequireCompliantDevice = $false
                    RequireApprovedClientApp = $false
                }
            }
        }
        
        # æ™‚é–“åˆ¶é™è¨­å®š
        $timeConditions = switch ($TimeRestriction) {
            "SchoolHours" {
                @{
                    StartTime = "08:00:00"
                    EndTime = "17:00:00"
                    Days = @("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")
                }
            }
            "AfterSchool" {
                @{
                    StartTime = "17:00:00"
                    EndTime = "21:00:00"
                    Days = @("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")
                }
            }
            "AllTime" {
                $null
            }
        }
        
        # æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ
        $policyParams = @{
            DisplayName = "$GroupName-SecurityPolicy"
            State = "enabled"
            Conditions = @{
                Users = @{
                    IncludeGroups = @($targetGroup.Id)
                }
                Applications = @{
                    IncludeApplications = @("All")
                }
            }
            GrantControls = @{
                Operator = "AND"
                BuiltInControls = @()
            }
        }
        
        # MFAè¦æ±‚ã®è¿½åŠ 
        if ($RequireMFA) {
            $policyParams.GrantControls.BuiltInControls += "mfa"
        }
        
        # ãƒ‡ãƒã‚¤ã‚¹æº–æ‹ è¦æ±‚ã®è¿½åŠ 
        if ($policySettings.RequireCompliantDevice) {
            $policyParams.GrantControls.BuiltInControls += "compliantDevice"
        }
        
        # æ‰¿èªæ¸ˆã¿ã‚¢ãƒ—ãƒªè¦æ±‚ã®è¿½åŠ 
        if ($policySettings.RequireApprovedClientApp) {
            $policyParams.GrantControls.BuiltInControls += "approvedApplication"
        }
        
        # å ´æ‰€åˆ¶é™ã®è¿½åŠ 
        if ($RestrictLocation) {
            $policyParams.Conditions.Locations = @{
                IncludeLocations = @("AllTrusted")
                ExcludeLocations = @("All")
            }
        }
        
        # æ™‚é–“åˆ¶é™ã®è¿½åŠ 
        if ($timeConditions) {
            # æ³¨: å®Ÿéš›ã®æ™‚é–“åˆ¶é™è¨­å®šã¯ã‚ˆã‚Šè¤‡é›‘ãªæ§‹æˆãŒå¿…è¦
            Write-Host "âš ï¸ æ™‚é–“åˆ¶é™è¨­å®šã¯å€‹åˆ¥ã®æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼è¨­å®šãŒå¿…è¦ã§ã™" -ForegroundColor Yellow
        }
        
        # ãƒãƒªã‚·ãƒ¼ã®é©ç”¨ï¼ˆå®Ÿéš›ã®ç’°å¢ƒã§ã¯æ…é‡ã«å®Ÿè¡Œï¼‰
        Write-Host "ğŸ“‹ è¨­å®šå†…å®¹:" -ForegroundColor Green
        Write-Host "  ã‚°ãƒ«ãƒ¼ãƒ—: $GroupName" -ForegroundColor White
        Write-Host "  ã‚¢ã‚¯ã‚»ã‚¹ãƒ¬ãƒ™ãƒ«: $AccessLevel" -ForegroundColor White
        Write-Host "  MFAè¦æ±‚: $RequireMFA" -ForegroundColor White
        Write-Host "  å ´æ‰€åˆ¶é™: $RestrictLocation" -ForegroundColor White
        Write-Host "  æ™‚é–“åˆ¶é™: $TimeRestriction" -ForegroundColor White
        
        Write-Host "âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼è¨­å®šå®Œäº†" -ForegroundColor Green
        
    } catch {
        Write-Error "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼è¨­å®šå¤±æ•—: $($_.Exception.Message)"
    }
}
```

### 4. ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™ã®åˆ¶å¾¡

#### æ•™è‚²æ©Ÿé–¢ã§ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™ç®¡ç†ã®é‡è¦æ€§

æ•™è‚²æ©Ÿé–¢ã§ã¯ã€ç„¡åˆ¶é™ãªã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã«ã‚ˆã‚Šä»¥ä¸‹ã®å•é¡ŒãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

```markdown
âš ï¸ ç„¡åˆ¶é™ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã®ãƒªã‚¹ã‚¯
- ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¹±ç«‹ã«ã‚ˆã‚‹ã‚¬ãƒãƒŠãƒ³ã‚¹ä½ä¸‹
- é‡è¤‡æ©Ÿèƒ½ã‚’æŒã¤ã‚°ãƒ«ãƒ¼ãƒ—ã®ç„¡ç§©åºãªå¢—åŠ 
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã«æº–æ‹ ã—ãªã„ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ
- ç®¡ç†è€…ã«ã‚ˆã‚‹çµ±åˆ¶ã®å›°é›£åŒ–
- ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ¶ˆè²»ã®ç„¡é§„ï¼ˆMicrosoft 365ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
```

#### ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™ã®åˆ¶é™æ–¹æ³•

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
Microsoft 365ãƒ†ãƒŠãƒ³ãƒˆã«ãŠã„ã¦ã€ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™ã‚’ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¾ãŸã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ¶é™ã—ã€æ•™è‚²æ©Ÿé–¢ã®ã‚¬ãƒãƒŠãƒ³ã‚¹è¦ä»¶ã‚’æº€ãŸã—ã¾ã™ã€‚ç®¡ç†è€…ã€æ•™å‹™ä¸»ä»»ã€å­¦å¹´ä¸»ä»»ãªã©ã€é©åˆ‡ãªæ¨©é™ã‚’æŒã¤äººå“¡ã®ã¿ãŒã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã§ãã‚‹ã‚ˆã†åˆ¶å¾¡ã—ã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªæ¨©é™åˆ¶é™ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
Restrict-GroupCreation -AllowedGroup "IT-Administrators" -RestrictType "AllGroups"

# æ•™è·å“¡ã®ã¿ã«åˆ¶é™
Restrict-GroupCreation -AllowedGroup "Faculty-Staff" -RestrictType "Microsoft365Groups"

# è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—ã«æ¨©é™ä»˜ä¸
$allowedGroups = @("School-Administrators", "Grade-Coordinators", "IT-Staff")
Restrict-GroupCreation -AllowedGroups $allowedGroups -RestrictType "AllGroups"
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-AllowedGroup`: ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã‚’è¨±å¯ã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—å
- `-AllowedGroups`: è¤‡æ•°ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹å ´åˆ
- `-RestrictType`: åˆ¶é™å¯¾è±¡ï¼ˆAllGroups/Microsoft365Groups/SecurityGroupsï¼‰
- `-EnableException`: ä¾‹å¤–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å€‹åˆ¥æŒ‡å®š

**ğŸ’¡ æ¨å¥¨æ¨©é™è¨­è¨ˆ**
- **ç®¡ç†è€…**: å…¨ç¨®é¡ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™
- **æ•™å‹™ä¸»ä»»ãƒ»å­¦å¹´ä¸»ä»»**: Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™
- **ä¸€èˆ¬æ•™è·å“¡**: ç”³è«‹ãƒ™ãƒ¼ã‚¹ã§ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
- **å­¦ç”Ÿ**: ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™ãªã—ï¼ˆæ•™å“¡ã«ã‚ˆã‚‹ä»£ç†ä½œæˆï¼‰

```powershell
function Restrict-GroupCreation {
    param(
        [string]$AllowedGroup,
        [string[]]$AllowedGroups,
        [ValidateSet("AllGroups", "Microsoft365Groups", "SecurityGroups")]
        [string]$RestrictType = "Microsoft365Groups",
        [string[]]$ExceptionUsers = @()
    )
    
    Write-Host "=== ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™åˆ¶é™è¨­å®š ===" -ForegroundColor Magenta
    Write-Host "åˆ¶é™ç¨®åˆ¥: $RestrictType" -ForegroundColor Cyan
    
    try {
        # è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ãƒªã‚¹ãƒˆã®çµ±åˆ
        $groupsToAllow = @()
        if ($AllowedGroup) { $groupsToAllow += $AllowedGroup }
        if ($AllowedGroups) { $groupsToAllow += $AllowedGroups }
        
        if ($groupsToAllow.Count -eq 0) {
            Write-Error "è¨±å¯ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"
            return
        }
        
        # Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™ã®è¨­å®š
        if ($RestrictType -in @("AllGroups", "Microsoft365Groups")) {
            Write-Host "`nğŸ”’ Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™åˆ¶é™ä¸­..." -ForegroundColor Yellow
            
            # ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å–å¾—
            $groupSettingsTemplate = Get-MgDirectorySettingTemplate | Where-Object { $_.DisplayName -eq "Group.Unified" }
            
            if (-not $groupSettingsTemplate) {
                Write-Error "Group.Unifiedè¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
                return
            }
            
            # ç¾åœ¨ã®è¨­å®šç¢ºèª
            $currentSettings = Get-MgDirectorySetting | Where-Object { $_.TemplateId -eq $groupSettingsTemplate.Id }
            
            if (-not $currentSettings) {
                # æ–°è¦è¨­å®šä½œæˆ
                Write-Host "æ–°è¦ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šã‚’ä½œæˆä¸­..." -ForegroundColor Yellow
                
                $settingValues = @()
                foreach ($settingTemplate in $groupSettingsTemplate.Values) {
                    $settingValue = @{
                        Name = $settingTemplate.Name
                        Value = $settingTemplate.DefaultValue
                    }
                    $settingValues += $settingValue
                }
                
                # ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã‚’åˆ¶é™
                $enableGroupCreation = $settingValues | Where-Object { $_.Name -eq "EnableGroupCreation" }
                $enableGroupCreation.Value = "false"
                
                # è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®š
                $groupCreationAllowedGroupId = $settingValues | Where-Object { $_.Name -eq "GroupCreationAllowedGroupId" }
                
                # æœ€åˆã®è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¨­å®šï¼ˆè¤‡æ•°ã®å ´åˆã¯å¾Œã§è¿½åŠ å‡¦ç†ï¼‰
                $firstAllowedGroup = Get-MgGroup -Filter "displayName eq '$($groupsToAllow[0])'"
                if ($firstAllowedGroup) {
                    $groupCreationAllowedGroupId.Value = $firstAllowedGroup.Id
                    Write-Host "  âœ“ è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š: $($groupsToAllow[0])" -ForegroundColor Green
                }
                
                # è¨­å®šã‚’é©ç”¨
                New-MgDirectorySetting -TemplateId $groupSettingsTemplate.Id -Values $settingValues
                Write-Host "  âœ… Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™ã‚’é©ç”¨ã—ã¾ã—ãŸ" -ForegroundColor Green
                
            } else {
                # æ—¢å­˜è¨­å®šã®æ›´æ–°
                Write-Host "æ—¢å­˜ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šã‚’æ›´æ–°ä¸­..." -ForegroundColor Yellow
                
                $settingValues = $currentSettings.Values
                
                # ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã‚’åˆ¶é™
                $enableGroupCreation = $settingValues | Where-Object { $_.Name -eq "EnableGroupCreation" }
                $enableGroupCreation.Value = "false"
                
                # è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã®æ›´æ–°
                $groupCreationAllowedGroupId = $settingValues | Where-Object { $_.Name -eq "GroupCreationAllowedGroupId" }
                $firstAllowedGroup = Get-MgGroup -Filter "displayName eq '$($groupsToAllow[0])'"
                if ($firstAllowedGroup) {
                    $groupCreationAllowedGroupId.Value = $firstAllowedGroup.Id
                }
                
                Update-MgDirectorySetting -DirectorySettingId $currentSettings.Id -Values $settingValues
                Write-Host "  âœ… Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™ã‚’æ›´æ–°ã—ã¾ã—ãŸ" -ForegroundColor Green
            }
        }
        
        # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™ï¼ˆMicrosoft Entra ID Premium P1/P2å¿…è¦ï¼‰
        if ($RestrictType -in @("AllGroups", "SecurityGroups")) {
            Write-Host "`nğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™åˆ¶é™ä¸­..." -ForegroundColor Yellow
            
            # æ³¨: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™ã«ã¯ã‚ˆã‚Šé«˜åº¦ãªæ¨©é™ç®¡ç†ãŒå¿…è¦
            Write-Host "  â„¹ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™ã«ã¯ã€ç®¡ç†è€…ãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹åˆ¶å¾¡ã‚’æ¨å¥¨ã—ã¾ã™" -ForegroundColor Cyan
            Write-Host "    - Group Administrator ãƒ­ãƒ¼ãƒ«ã®é©åˆ‡ãªå‰²ã‚Šå½“ã¦" -ForegroundColor Gray
            Write-Host "    - æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚‹åˆ¶å¾¡" -ForegroundColor Gray
        }
        
        # è¤‡æ•°è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã®å‡¦ç†ï¼ˆå‚™è€ƒï¼‰
        if ($groupsToAllow.Count -gt 1) {
            Write-Host "`nğŸ“‹ è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—è¨±å¯ã«ã¤ã„ã¦:" -ForegroundColor Yellow
            Write-Host "  Microsoft 365ã®æ¨™æº–è¨­å®šã§ã¯ã€1ã¤ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®ã¿æŒ‡å®šå¯èƒ½ã§ã™" -ForegroundColor Gray
            Write-Host "  è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—ã«æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹å ´åˆã®æ¨å¥¨æ–¹æ³•:" -ForegroundColor Gray
            Write-Host "    1. 'Group-Creators' ã¨ã„ã†çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆ" -ForegroundColor Gray
            Write-Host "    2. å€‹åˆ¥ã®è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã‚’çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã«è¿½åŠ " -ForegroundColor Gray
            
            # çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—ã®è‡ªå‹•ä½œæˆææ¡ˆ
            $createUnifiedGroup = Read-Host "`nçµ±åˆã‚°ãƒ«ãƒ¼ãƒ— 'Group-Creators' ã‚’è‡ªå‹•ä½œæˆã—ã¾ã™ã‹ï¼Ÿ (y/n)"
            if ($createUnifiedGroup -eq 'y') {
                try {
                    $unifiedGroup = New-MgGroup -DisplayName "Group-Creators" -Description "Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—" -SecurityEnabled $true
                    
                    # å„è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã‚’çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ 
                    foreach ($allowedGroupName in $groupsToAllow) {
                        $allowedGroupObj = Get-MgGroup -Filter "displayName eq '$allowedGroupName'"
                        if ($allowedGroupObj) {
                            New-MgGroupMember -GroupId $unifiedGroup.Id -DirectoryObjectId $allowedGroupObj.Id
                            Write-Host "    âœ“ $allowedGroupName ã‚’ Group-Creators ã«è¿½åŠ " -ForegroundColor Green
                        }
                    }
                    
                    Write-Host "  âœ… çµ±åˆã‚°ãƒ«ãƒ¼ãƒ— 'Group-Creators' ã‚’ä½œæˆã—ã¾ã—ãŸ" -ForegroundColor Green
                    Write-Host "    æ¬¡å›ã¯ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—IDã‚’ GroupCreationAllowedGroupId ã«è¨­å®šã—ã¦ãã ã•ã„" -ForegroundColor Cyan
                    
                } catch {
                    Write-Error "çµ±åˆã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆå¤±æ•—: $($_.Exception.Message)"
                }
            }
        }
        
        # è¨­å®šç¢ºèªã¨æ¨å¥¨äº‹é …
        Write-Host "`n=== è¨­å®šç¢ºèª ===" -ForegroundColor Magenta
        Write-Host "åˆ¶é™å¯¾è±¡: $RestrictType" -ForegroundColor White
        Write-Host "è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—: $($groupsToAllow -join ', ')" -ForegroundColor White
        
        Write-Host "`nğŸ“‹ æ¨å¥¨ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ä½œæ¥­:" -ForegroundColor Yellow
        Write-Host "  1. è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ç¢ºèª" -ForegroundColor Gray
        Write-Host "  2. ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å¤‰æ›´é€šçŸ¥" -ForegroundColor Gray
        Write-Host "  3. ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆç”³è«‹ãƒ—ãƒ­ã‚»ã‚¹ã®æ•´å‚™" -ForegroundColor Gray
        Write-Host "  4. å®šæœŸçš„ãªæ¨©é™ç›£æŸ»ã®å®Ÿæ–½" -ForegroundColor Gray
        
    } catch {
        Write-Error "ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™åˆ¶é™å¤±æ•—: $($_.Exception.Message)"
    }
}

# æ¨©é™ç¢ºèªç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
function Get-GroupCreationPermissions {
    Write-Host "=== ç¾åœ¨ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆæ¨©é™è¨­å®š ===" -ForegroundColor Magenta
    
    try {
        # Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šç¢ºèª
        $groupSettingsTemplate = Get-MgDirectorySettingTemplate | Where-Object { $_.DisplayName -eq "Group.Unified" }
        $currentSettings = Get-MgDirectorySetting | Where-Object { $_.TemplateId -eq $groupSettingsTemplate.Id }
        
        if ($currentSettings) {
            $enableGroupCreation = ($currentSettings.Values | Where-Object { $_.Name -eq "EnableGroupCreation" }).Value
            $allowedGroupId = ($currentSettings.Values | Where-Object { $_.Name -eq "GroupCreationAllowedGroupId" }).Value
            
            Write-Host "`nMicrosoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆè¨­å®š:" -ForegroundColor Green
            Write-Host "  ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆè¨±å¯: $enableGroupCreation" -ForegroundColor White
            
            if ($allowedGroupId) {
                $allowedGroup = Get-MgGroup -GroupId $allowedGroupId -ErrorAction SilentlyContinue
                if ($allowedGroup) {
                    Write-Host "  è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—: $($allowedGroup.DisplayName) ($allowedGroupId)" -ForegroundColor White
                    
                    # è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ç¢ºèª
                    $members = Get-MgGroupMember -GroupId $allowedGroupId
                    Write-Host "  è¨±å¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: $($members.Count)å" -ForegroundColor White
                }
            } else {
                Write-Host "  è¨±å¯ã‚°ãƒ«ãƒ¼ãƒ—: æœªè¨­å®š" -ForegroundColor Yellow
            }
        } else {
            Write-Host "Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆåˆ¶é™: æœªè¨­å®šï¼ˆå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆå¯èƒ½ï¼‰" -ForegroundColor Yellow
        }
        
        # ç®¡ç†è€…ãƒ­ãƒ¼ãƒ«ç¢ºèª
        Write-Host "`nç®¡ç†è€…ãƒ­ãƒ¼ãƒ«è¨­å®š:" -ForegroundColor Green
        $groupAdmins = Get-MgDirectoryRoleDefinition | Where-Object { $_.DisplayName -eq "Groups Administrator" }
        if ($groupAdmins) {
            $groupAdminAssignments = Get-MgRoleManagementDirectoryRoleAssignment -Filter "roleDefinitionId eq '$($groupAdmins.Id)'"
            Write-Host "  Groups Administrator: $($groupAdminAssignments.Count)åã«å‰²ã‚Šå½“ã¦æ¸ˆã¿" -ForegroundColor White
        }
        
    } catch {
        Write-Error "æ¨©é™ç¢ºèªå¤±æ•—: $($_.Exception.Message)"
    }
}
```

#### æ•™è‚²æ©Ÿé–¢ã§ã®æ¨å¥¨æ¨©é™è¨­è¨ˆä¾‹

```markdown
ğŸ« å­¦æ ¡ã§ã®æ¨©é™éšå±¤è¨­è¨ˆ

**ãƒ¬ãƒ™ãƒ«1: å…¨æ¨©é™ï¼ˆITç®¡ç†è€…ï¼‰**
- ã‚°ãƒ«ãƒ¼ãƒ—ç¨®åˆ¥: å…¨ç¨®é¡
- æ¨©é™ç¯„å›²: ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤ãƒ»æ¨©é™å¤‰æ›´
- å¯¾è±¡: ITç®¡ç†è€…ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…

**ãƒ¬ãƒ™ãƒ«2: æ•™è‚²ç®¡ç†æ¨©é™ï¼ˆæ•™å‹™ãƒ»ç®¡ç†è·ï¼‰**
- ã‚°ãƒ«ãƒ¼ãƒ—ç¨®åˆ¥: Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ã€é…å¸ƒã‚°ãƒ«ãƒ¼ãƒ—
- æ¨©é™ç¯„å›²: ä½œæˆãƒ»ç·¨é›†ãƒ»ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†
- å¯¾è±¡: æ ¡é•·ã€æ•™é ­ã€æ•™å‹™ä¸»ä»»ã€å­¦å¹´ä¸»ä»»

**ãƒ¬ãƒ™ãƒ«3: æ•™ç§‘ãƒ»éƒ¨æ´»å‹•æ¨©é™ï¼ˆä¸€èˆ¬æ•™å“¡ï¼‰**
- ã‚°ãƒ«ãƒ¼ãƒ—ç¨®åˆ¥: Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆç”³è«‹ãƒ™ãƒ¼ã‚¹ï¼‰
- æ¨©é™ç¯„å›²: è‡ªåˆ†ãŒä½œæˆã—ãŸã‚°ãƒ«ãƒ¼ãƒ—ã®ç®¡ç†
- å¯¾è±¡: æ•™ç§‘æ‹…å½“ã€éƒ¨æ´»å‹•é¡§å•

**ãƒ¬ãƒ™ãƒ«4: å‚åŠ ã®ã¿ï¼ˆå­¦ç”Ÿãƒ»ä¿è­·è€…ï¼‰**
- ã‚°ãƒ«ãƒ¼ãƒ—ç¨®åˆ¥: ãªã—ï¼ˆä½œæˆæ¨©é™ãªã—ï¼‰
- æ¨©é™ç¯„å›²: æ‹›å¾…ã•ã‚ŒãŸã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®å‚åŠ ã®ã¿
- å¯¾è±¡: å­¦ç”Ÿã€ä¿è­·è€…ã€å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼
```

#### ç”³è«‹ãƒ™ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆãƒ•ãƒ­ãƒ¼ã®æ§‹ç¯‰

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
Power Automateã‚„Microsoft Formsã¨é€£æºã—ã¦ã€ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆç”³è«‹ã‹ã‚‰æ‰¿èªã€è‡ªå‹•ä½œæˆã¾ã§ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚æ•™å“¡ã‹ã‚‰ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆè¦æ±‚ã‚’ç®¡ç†è€…ãŒå¯©æŸ»ãƒ»æ‰¿èªå¾Œã€è‡ªå‹•çš„ã«ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã™ã‚‹ä»•çµ„ã¿ã‚’æä¾›ã—ã¾ã™ã€‚

**ğŸ“‹ ç”³è«‹ãƒ•ãƒ­ãƒ¼ã®è¨­è¨ˆä¾‹**

```markdown
ğŸ”„ ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆç”³è«‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

1. **ç”³è«‹ï¼ˆMicrosoft Formsï¼‰**
   - ç”³è«‹è€…: æ•™å“¡
   - ç”³è«‹å†…å®¹: ã‚°ãƒ«ãƒ¼ãƒ—åã€ç›®çš„ã€ãƒ¡ãƒ³ãƒãƒ¼äºˆå®šæ•°ã€æœŸé–“
   - è‡ªå‹•é …ç›®: ç”³è«‹è€…æƒ…å ±ã€ç”³è«‹æ—¥æ™‚

2. **ä¸€æ¬¡ç¢ºèªï¼ˆè‡ªå‹•ï¼‰**
   - å‘½åè¦å‰‡ãƒã‚§ãƒƒã‚¯
   - é‡è¤‡ã‚°ãƒ«ãƒ¼ãƒ—åç¢ºèª
   - ç”³è«‹è€…æ¨©é™ç¢ºèª

3. **æ‰¿èªï¼ˆç®¡ç†è€…ï¼‰**
   - ç”³è«‹å†…å®¹ãƒ¬ãƒ“ãƒ¥ãƒ¼
   - æ‰¿èªãƒ»å´ä¸‹ãƒ»ä¿®æ­£è¦æ±‚

4. **è‡ªå‹•ä½œæˆï¼ˆPowerShellï¼‰**
   - æ‰¿èªå¾Œã®è‡ªå‹•ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
   - åˆæœŸãƒ¡ãƒ³ãƒãƒ¼è¨­å®š
   - ç”³è«‹è€…ã¸ã®å®Œäº†é€šçŸ¥

5. **äº‹å¾Œç®¡ç†**
   - ã‚°ãƒ«ãƒ¼ãƒ—æ´»å‹•ç›£è¦–
   - æœŸé™åˆ‡ã‚Œã‚°ãƒ«ãƒ¼ãƒ—ã®è‡ªå‹•ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
```

```powershell
# ç”³è«‹ãƒ™ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã®å®Ÿè£…ä¾‹
function Process-GroupCreationRequest {
    param(
        [PSCustomObject]$ApprovalData,
        [switch]$AutoCreate
    )
    
    Write-Host "ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆç”³è«‹å‡¦ç†é–‹å§‹..." -ForegroundColor Cyan
    
    try {
        # ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼
        $validationResult = Test-GroupCreationRequest -RequestData $ApprovalData
        
        if (-not $validationResult.IsValid) {
            Write-Warning "ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã«å•é¡ŒãŒã‚ã‚Šã¾ã™: $($validationResult.Issues -join ', ')"
            return
        }
        
        if ($AutoCreate) {
            # è‡ªå‹•ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
            $groupParams = @{
                DisplayName = $ApprovalData.GroupName
                Description = $ApprovalData.Purpose
                GroupTypes = @("Unified")
                MailEnabled = $true
                SecurityEnabled = $false
                MailNickname = ($ApprovalData.GroupName -replace '[^a-zA-Z0-9]', '').ToLower()
            }
            
            $newGroup = New-MgGroup @groupParams
            
            # ç”³è«‹è€…ã‚’æ‰€æœ‰è€…ã«è¨­å®š
            $requester = Get-MgUser -Filter "userPrincipalName eq '$($ApprovalData.RequesterEmail)'"
            if ($requester) {
                New-MgGroupOwner -GroupId $newGroup.Id -DirectoryObjectId $requester.Id
            }
            
            Write-Host "âœ… ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆå®Œäº†: $($ApprovalData.GroupName)" -ForegroundColor Green
            return $newGroup
        }
        
    } catch {
        Write-Error "ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆç”³è«‹å‡¦ç†å¤±æ•—: $($_.Exception.Message)"
    }
}
```

### 5. School Data Sync (SDS) ã¨ã®é€£æº

#### æ ¡å‹™æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã¨ã®è‡ªå‹•åŒæœŸ

School Data Syncï¼ˆSDSï¼‰ã¯ã€æ ¡å‹™æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã¨Microsoftè£½å“ã‚’é€£æºã™ã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è‡ªå‹•ä½œæˆã‚„å±¥ä¿®æƒ…å ±ã«åŸºã¥ã„ãŸTeams ã®æ§‹ç¯‰ãŒå¯èƒ½ã§ã€å­¦æ ¡ã®ç®¡ç†è² æ‹…ã‚’è»½æ¸›ã—ã¾ã™

**ğŸ¯ SDSé€£æºã®ãƒ¡ãƒªãƒƒãƒˆ**

```markdown
ğŸ”„ è‡ªå‹•åŒ–ã•ã‚Œã‚‹æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹
1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†**: å­¦ç±æƒ…å ±â†’Microsoft 365ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè‡ªå‹•ä½œæˆ
2. **ã‚¯ãƒ©ã‚¹ç·¨æˆ**: å±¥ä¿®æƒ…å ±â†’Teams ã‚¯ãƒ©ã‚¹è‡ªå‹•æ§‹ç¯‰
3. **ã‚°ãƒ«ãƒ¼ãƒ—æ›´æ–°**: æ™‚é–“å‰²å¤‰æ›´â†’é–¢é€£ã‚°ãƒ«ãƒ¼ãƒ—è‡ªå‹•æ›´æ–°
4. **å¹´æ¬¡é€²ç´š**: å­¦å¹´æ›´æ–°â†’å…¨ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—è‡ªå‹•ç§»è¡Œ
5. **ä¿è­·è€…é€£æº**: ä¿è­·è€…æƒ…å ±â†’Teams ä¿è­·è€…æ©Ÿèƒ½è‡ªå‹•è¨­å®š
```

#### SDSç”¨CSVãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­è¨ˆ

**ğŸ“Š æ¨™æº–çš„ãªSDS CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**

**School.csv**
```csv
SIS ID,Name,School Number
sch123,ã‚µãƒ³ãƒ—ãƒ«ä¸­å­¦æ ¡,123
```

**Section.csv**  
```csv
SIS ID,School SIS ID,Section Name,Section Number,Term SIS ID,Term Name,Period
sec001,sch123,1å¹´Açµ„æ•°å­¦,1A-MATH,term2025,2025å¹´åº¦,1
sec002,sch123,1å¹´Açµ„å›½èª,1A-JPN,term2025,2025å¹´åº¦,2
```

**Teacher.csv**
```csv
SIS ID,School SIS ID,Username,First Name,Last Name,Middle Name,Title,Teacher Number,Status,Secondary Email
tea001,sch123,t.tanaka@school.edu.jp,å¤ªéƒ,ç”°ä¸­,,æ•°å­¦æ•™è«­,T001,Active,tanaka@school.local
```

**Student.csv**
```csv
SIS ID,School SIS ID,Username,First Name,Last Name,Middle Name,Grade,Student Number,Status,Secondary Email,Password
stu001,sch123,s001@school.edu.jp,èŠ±å­,ä½è—¤,,1,S001,Active,sato@school.local,TempPass123!
```

**StudentEnrollment.csv**
```csv
Section SIS ID,SIS ID
sec001,stu001
sec002,stu001
```

---

## ğŸ”„ å¹´æ¬¡æ›´æ–°ã®è‡ªå‹•åŒ–

### 1. å¹´åº¦æœ«ãƒ»å¹´åº¦åˆã‚ã®èª²é¡Œ

#### æ•™è‚²æ©Ÿé–¢ç‰¹æœ‰ã®å¤§è¦æ¨¡æ›´æ–°è¦ä»¶

```markdown
ğŸ“… å¹´æ¬¡æ›´æ–°ã§ç™ºç”Ÿã™ã‚‹ä¸»è¦èª²é¡Œ

**å¹´åº¦æœ«å‡¦ç†ï¼ˆ3æœˆï¼‰**
- å’æ¥­ç”Ÿã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‡¦ç†ï¼ˆç„¡åŠ¹åŒ–ãƒ»ãƒ‡ãƒ¼ã‚¿ä¿è­·ãƒ»å‰Šé™¤ï¼‰
- é€²ç´šäºˆå®šè€…ã®ä»®ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•
- æ•™è·å“¡ç•°å‹•ã«ä¼´ã†ã‚°ãƒ«ãƒ¼ãƒ—å†ç·¨
- éƒ¨æ´»å‹•ãƒ»å§”å“¡ä¼šã®å¼•ãç¶™ãå‡¦ç†
- ä¸€æ™‚çš„ãªã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ

**å¹´åº¦åˆã‚å‡¦ç†ï¼ˆ4æœˆï¼‰**  
- æ–°å…¥ç”Ÿã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€æ‹¬ä½œæˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—é…å±
- é€²ç´šã«ä¼´ã†ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—æ›´æ–°
- æ–°å¹´åº¦ã‚¯ãƒ©ã‚¹ãƒ»æ™‚é–“å‰²å¯¾å¿œã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
- æ•™è·å“¡æ–°é…å±ãƒ»æ‹…å½“å¤‰æ›´åæ˜ 
- æ ¡å‹™ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ‡ãƒ¼ã‚¿æ›´æ–°

**ç¶™ç¶šçš„ãªèª²é¡Œ**
- è»¢æ ¡ãƒ»è»¢å…¥ãƒ»ä¼‘å­¦è€…ã®éšæ™‚å¯¾å¿œ
- å¹´åº¦é€”ä¸­ã®ã‚¯ãƒ©ã‚¹æ›¿ãˆãƒ»æ‹…å½“å¤‰æ›´
- æ–°è¦æ•™è·å“¡ãƒ»éå¸¸å‹¤è¬›å¸«ã®è¿½åŠ 
- ã‚·ã‚¹ãƒ†ãƒ é–“ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ç¶­æŒ
```

### 2. æ®µéšçš„å¹´æ¬¡æ›´æ–°æˆ¦ç•¥

#### Phase 1: äº‹å‰æº–å‚™ãƒ»ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ï¼ˆ2æœˆä¸­æ—¬ã€œ3æœˆä¸Šæ—¬ï¼‰

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
å¹´æ¬¡æ›´æ–°å‰ã®ç¾çŠ¶ãƒ‡ãƒ¼ã‚¿ã‚’åŒ…æ‹¬çš„ã«åˆ†æã—ã€å•é¡Œã®ã‚ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’äº‹å‰ã«ç‰¹å®šãƒ»ä¿®æ­£ã—ã¾ã™ã€‚å’æ¥­äºˆå®šè€…ã€é€²ç´šäºˆå®šè€…ã€æ•™è·å“¡ç•°å‹•æƒ…å ±ã‚’æ•´ç†ã—ã€å††æ»‘ãªå¹´æ¬¡æ›´æ–°ã®æº–å‚™ã‚’è¡Œã„ã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªå¹´æ¬¡æ›´æ–°æº–å‚™
Prepare-AnnualUpdate -CurrentAcademicYear 2024 -NextAcademicYear 2025 -OutputPath "C:\reports\annual_update_prep.xlsx"

# ç‰¹å®šã®å•é¡Œã®ã¿ãƒã‚§ãƒƒã‚¯
Prepare-AnnualUpdate -CheckType "GraduatingStudents" -OutputPath "C:\reports\graduates_2025.csv"

# è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
Prepare-AnnualUpdate -Detailed -IncludeRecommendations -OutputPath "C:\reports\comprehensive_analysis.xlsx"
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-CurrentAcademicYear`: ç¾åœ¨ã®å¹´åº¦
- `-NextAcademicYear`: æ–°å¹´åº¦
- `-CheckType`: ãƒã‚§ãƒƒã‚¯ç¨®åˆ¥ï¼ˆAll/GraduatingStudents/PromotingStudents/Facultyï¼‰
- `-OutputPath`: åˆ†æçµæœã®å‡ºåŠ›å…ˆ
- `-Detailed`: è©³ç´°ãªåˆ†æãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- `-IncludeRecommendations`: æ”¹å–„ææ¡ˆã‚’å«ã‚ã‚‹

```powershell
function Prepare-AnnualUpdate {
    param(
        [int]$CurrentAcademicYear = (Get-Date).Year,
        [int]$NextAcademicYear = (Get-Date).Year + 1,
        [ValidateSet("All", "GraduatingStudents", "PromotingStudents", "Faculty")]
        [string]$CheckType = "All",
        [string]$OutputPath,
        [switch]$Detailed,
        [switch]$IncludeRecommendations
    )
    
    Write-Host "=== å¹´æ¬¡æ›´æ–°æº–å‚™åˆ†æé–‹å§‹ ===" -ForegroundColor Magenta
    Write-Host "å¯¾è±¡å¹´åº¦: $CurrentAcademicYear â†’ $NextAcademicYear" -ForegroundColor Cyan
    
    $analysisResults = @{
        GraduatingStudents = @()
        PromotingStudents = @()
        FacultyChanges = @()
        OrphanedGroups = @()
        ProblematicAccounts = @()
        Recommendations = @()
    }
    
    try {
        if ($CheckType -in @("All", "GraduatingStudents")) {
            Write-Host "`nğŸ“Š å’æ¥­äºˆå®šè€…åˆ†æä¸­..." -ForegroundColor Yellow
            
            # å’æ¥­äºˆå®šè€…ï¼ˆæœ€é«˜å­¦å¹´ï¼‰ã®ç‰¹å®š
            $graduatingStudents = Get-MgUser -Filter "extensionAttribute1 eq 'Grade3' and userType eq 'Member'" -All |
                Where-Object { $_.UserPrincipalName -like "*@school.edu.jp" }
            
            foreach ($student in $graduatingStudents) {
                $studentInfo = @{
                    UserPrincipalName = $student.UserPrincipalName
                    DisplayName = $student.DisplayName
                    Department = $student.Department
                    LastSignIn = $student.SignInActivity.LastSignInDateTime
                    GroupMemberships = (Get-MgUserMemberOf -UserId $student.Id).Count
                    HasLicense = (Get-MgUserLicenseDetail -UserId $student.Id).Count -gt 0
                    DataSize = "åˆ†æä¸­" # OneDriveä½¿ç”¨é‡ç­‰ã®åˆ†æ
                    Action = "å’æ¥­å‡¦ç†äºˆå®š"
                }
                $analysisResults.GraduatingStudents += $studentInfo
            }
            
            Write-Host "  âœ“ å’æ¥­äºˆå®šè€…: $($graduatingStudents.Count)å" -ForegroundColor Green
        }
        
        if ($CheckType -in @("All", "PromotingStudents")) {
            Write-Host "`nğŸ“Š é€²ç´šäºˆå®šè€…åˆ†æä¸­..." -ForegroundColor Yellow
            
            # é€²ç´šäºˆå®šè€…ï¼ˆ1ãƒ»2å¹´ç”Ÿï¼‰ã®ç‰¹å®š
            $promotingStudents = Get-MgUser -Filter "(extensionAttribute1 eq 'Grade1' or extensionAttribute1 eq 'Grade2') and userType eq 'Member'" -All
            
            foreach ($student in $promotingStudents) {
                $currentGrade = $student.ExtensionAttribute1
                $nextGrade = switch ($currentGrade) {
                    "Grade1" { "Grade2" }
                    "Grade2" { "Grade3" }
                }
                
                $studentInfo = @{
                    UserPrincipalName = $student.UserPrincipalName
                    DisplayName = $student.DisplayName
                    CurrentGrade = $currentGrade
                    NextGrade = $nextGrade
                    CurrentGroups = @()
                    RequiredNewGroups = @()
                    Action = "é€²ç´šå‡¦ç†äºˆå®š"
                }
                
                # ç¾åœ¨ã®ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—
                $userGroups = Get-MgUserMemberOf -UserId $student.Id
                $studentInfo.CurrentGroups = $userGroups | ForEach-Object { $_.AdditionalProperties.displayName }
                
                $analysisResults.PromotingStudents += $studentInfo
            }
            
            Write-Host "  âœ“ é€²ç´šäºˆå®šè€…: $($promotingStudents.Count)å" -ForegroundColor Green
        }
        
        if ($CheckType -in @("All", "Faculty")) {
            Write-Host "`nğŸ“Š æ•™è·å“¡ç•°å‹•åˆ†æä¸­..." -ForegroundColor Yellow
            
            # æ•™è·å“¡ã®ç¾çŠ¶åˆ†æ
            $facultyMembers = Get-MgUser -Filter "userType eq 'Member' and (jobTitle ne null)" -All |
                Where-Object { $_.JobTitle -like "*æ•™*" -or $_.JobTitle -like "*è·å“¡*" }
            
            foreach ($faculty in $facultyMembers) {
                $facultyInfo = @{
                    UserPrincipalName = $faculty.UserPrincipalName
                    DisplayName = $faculty.DisplayName
                    JobTitle = $faculty.JobTitle
                    Department = $faculty.Department
                    ManagerAssigned = ($faculty.Manager -ne $null)
                    GroupMemberships = (Get-MgUserMemberOf -UserId $faculty.Id).Count
                    LastActivity = $faculty.SignInActivity.LastSignInDateTime
                    Action = "ç¶™ç¶šç¢ºèªå¿…è¦"
                }
                $analysisResults.FacultyChanges += $facultyInfo
            }
            
            Write-Host "  âœ“ æ•™è·å“¡: $($facultyMembers.Count)å" -ForegroundColor Green
        }
        
        # å•é¡Œã®ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ãƒ»ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ç‰¹å®š
        if ($CheckType -eq "All") {
            Write-Host "`nğŸ“Š å•é¡Œã®ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ãƒ»ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ†æä¸­..." -ForegroundColor Yellow
            
            # æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ—ã®ç‰¹å®š
            $allGroups = Get-MgGroup -All
            foreach ($group in $allGroups) {
                $owners = Get-MgGroupOwner -GroupId $group.Id -ErrorAction SilentlyContinue
                if ($owners.Count -eq 0) {
                    $analysisResults.OrphanedGroups += @{
                        GroupName = $group.DisplayName
                        GroupId = $group.Id
                        MemberCount = (Get-MgGroupMember -GroupId $group.Id).Count
                        CreatedDate = $group.CreatedDateTime
                        Issue = "æ‰€æœ‰è€…ä¸åœ¨"
                    }
                }
            }
            
            # é•·æœŸé–“ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãªã—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
            $inactiveUsers = Get-MgUser -All | Where-Object {
                $_.SignInActivity.LastSignInDateTime -and
                (Get-Date) - [datetime]$_.SignInActivity.LastSignInDateTime > (New-TimeSpan -Days 90)
            }
            
            foreach ($user in $inactiveUsers) {
                $analysisResults.ProblematicAccounts += @{
                    UserPrincipalName = $user.UserPrincipalName
                    DisplayName = $user.DisplayName
                    LastSignIn = $user.SignInActivity.LastSignInDateTime
                    Issue = "90æ—¥ä»¥ä¸Šæœªãƒ­ã‚°ã‚¤ãƒ³"
                    Recommendation = "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçŠ¶æ³ç¢ºèªãƒ»å¿…è¦ã«å¿œã˜ã¦ç„¡åŠ¹åŒ–"
                }
            }
        }
        
        # æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆ
        if ($IncludeRecommendations) {
            Write-Host "`nğŸ“‹ æ”¹å–„ææ¡ˆç”Ÿæˆä¸­..." -ForegroundColor Yellow
            
            $analysisResults.Recommendations = @(
                "å’æ¥­ç”Ÿ $($analysisResults.GraduatingStudents.Count)åã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‡¦ç†è¨ˆç”»ã‚’ç­–å®š",
                "é€²ç´šè€… $($analysisResults.PromotingStudents.Count)åã®ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆæº–å‚™",
                "æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ— $($analysisResults.OrphanedGroups.Count)ä»¶ã®æ‰€æœ‰è€…æŒ‡å®š",
                "éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ $($analysisResults.ProblematicAccounts.Count)ä»¶ã®çŠ¶æ³ç¢ºèª",
                "æ–°å¹´åº¦ç”¨ã‚°ãƒ«ãƒ¼ãƒ—ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®äº‹å‰ä½œæˆ",
                "ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æˆ¦ç•¥ã®ç¢ºèª"
            )
        }
        
        # çµæœå‡ºåŠ›
        if ($OutputPath) {
            $analysisResults | ConvertTo-Json -Depth 10 | Out-File "$OutputPath.json" -Encoding UTF8
            Write-Host "`nğŸ“„ åˆ†æçµæœã‚’å‡ºåŠ›ã—ã¾ã—ãŸ: $OutputPath.json" -ForegroundColor Green
        }
        
        # ã‚µãƒãƒªãƒ¼è¡¨ç¤º
        Write-Host "`n=== åˆ†æçµæœã‚µãƒãƒªãƒ¼ ===" -ForegroundColor Magenta
        Write-Host "å’æ¥­äºˆå®šè€…: $($analysisResults.GraduatingStudents.Count)å" -ForegroundColor Cyan
        Write-Host "é€²ç´šäºˆå®šè€…: $($analysisResults.PromotingStudents.Count)å" -ForegroundColor Cyan
        Write-Host "æ•™è·å“¡: $($analysisResults.FacultyChanges.Count)å" -ForegroundColor Cyan
        Write-Host "æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ—: $($analysisResults.OrphanedGroups.Count)ä»¶" -ForegroundColor Yellow
        Write-Host "è¦ç¢ºèªã‚¢ã‚«ã‚¦ãƒ³ãƒˆ: $($analysisResults.ProblematicAccounts.Count)ä»¶" -ForegroundColor Yellow
        
        return $analysisResults
        
    } catch {
        Write-Error "å¹´æ¬¡æ›´æ–°æº–å‚™åˆ†æå¤±æ•—: $($_.Exception.Message)"
    }
}
```

#### Phase 2: å’æ¥­ç”Ÿå‡¦ç†ãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆ3æœˆä¸­æ—¬ï¼‰

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
å’æ¥­ç”Ÿã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ã«å‡¦ç†ã—ã€å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã¯ä¿è­·ã—ãªãŒã‚‰ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã—ã¾ã™ã€‚æ®µéšçš„ãªå‡¦ç†ã«ã‚ˆã‚Šã€èª¤æ“ä½œã®ãƒªã‚¹ã‚¯ã‚’æœ€å°åŒ–ã—ã€å¿…è¦ã«å¿œã˜ãŸãƒ‡ãƒ¼ã‚¿å¾©æ—§ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªå’æ¥­ç”Ÿå‡¦ç†
Process-GraduatingStudents -GraduationYear 2025 -ArchivePeriod 180 -Stage "All"

# æ®µéšçš„å‡¦ç†ï¼ˆãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰Šé™¤ã®ã¿ï¼‰
Process-GraduatingStudents -GraduationYear 2025 -Stage "RemoveLicenses"

# ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä»˜ãå‡¦ç†
Process-GraduatingStudents -GraduationYear 2025 -CreateArchive -ArchivePath "\\server\archives\graduates2025"
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-GraduationYear`: å’æ¥­å¹´åº¦
- `-Stage`: å‡¦ç†æ®µéšï¼ˆRemoveLicenses/DisableAccounts/ArchiveData/Allï¼‰
- `-ArchivePeriod`: ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¿æŒæœŸé–“ï¼ˆæ—¥æ•°ï¼‰
- `-CreateArchive`: ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä½œæˆ
- `-ArchivePath`: ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆ

```powershell
function Process-GraduatingStudents {
    param(
        [int]$GraduationYear = (Get-Date).Year,
        [ValidateSet("RemoveLicenses", "DisableAccounts", "ArchiveData", "All")]
        [string]$Stage = "All",
        [int]$ArchivePeriod = 180,
        [switch]$CreateArchive,
        [string]$ArchivePath
    )
    
    Write-Host "=== å’æ¥­ç”Ÿå‡¦ç†é–‹å§‹ ===" -ForegroundColor Magenta
    Write-Host "å¯¾è±¡: $GraduationYear å¹´åº¦å’æ¥­ç”Ÿ" -ForegroundColor Cyan
    
    try {
        # å’æ¥­å¯¾è±¡è€…ã®ç‰¹å®š
        $graduatingStudents = Get-MgUser -Filter "extensionAttribute1 eq 'Grade3' and userType eq 'Member'" -All |
            Where-Object { $_.UserPrincipalName -like "*@school.edu.jp" }
        
        if ($graduatingStudents.Count -eq 0) {
            Write-Warning "å’æ¥­å¯¾è±¡å­¦ç”ŸãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
            return
        }
        
        Write-Host "å’æ¥­å¯¾è±¡å­¦ç”Ÿ: $($graduatingStudents.Count)å" -ForegroundColor Green
        
        $processResults = @{
            LicenseRemoved = @()
            AccountsDisabled = @()
            DataArchived = @()
            Errors = @()
        }
        
        foreach ($student in $graduatingStudents) {
            Write-Host "`nå‡¦ç†ä¸­: $($student.DisplayName) ($($student.UserPrincipalName))" -ForegroundColor Cyan
            
            try {
                # Stage 1: ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰Šé™¤ï¼ˆå³åº§ã«ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰
                if ($Stage -in @("RemoveLicenses", "All")) {
                    $userLicenses = Get-MgUserLicenseDetail -UserId $student.Id -ErrorAction SilentlyContinue
                    if ($userLicenses) {
                        $licenseSkuIds = $userLicenses.SkuId
                        Set-MgUserLicense -UserId $student.Id -AddLicenses @() -RemoveLicenses $licenseSkuIds
                        $processResults.LicenseRemoved += $student.UserPrincipalName
                        Write-Host "  âœ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰Šé™¤å®Œäº†" -ForegroundColor Green
                    }
                }
                
                # Stage 2: ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
                if ($CreateArchive -and ($Stage -in @("ArchiveData", "All"))) {
                    if ($ArchivePath) {
                        $userArchivePath = Join-Path $ArchivePath $student.UserPrincipalName
                        
                        # OneDriveãƒ‡ãƒ¼ã‚¿ã®æƒ…å ±å–å¾—ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã¯åˆ¥é€”ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ï¼‰
                        $driveInfo = Get-MgUserDrive -UserId $student.Id -ErrorAction SilentlyContinue
                        if ($driveInfo) {
                            # ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æŒ‡ç¤ºã®è¨˜éŒ²
                            $archiveInfo = @{
                                UserPrincipalName = $student.UserPrincipalName
                                DisplayName = $student.DisplayName
                                DriveSize = $driveInfo.Quota.Used
                                ArchivePath = $userArchivePath
                                ArchiveDate = Get-Date
                                RetentionUntil = (Get-Date).AddDays($ArchivePeriod)
                            }
                            $processResults.DataArchived += $archiveInfo
                            Write-Host "  âœ“ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æƒ…å ±è¨˜éŒ²å®Œäº†" -ForegroundColor Green
                        }
                    }
                }
                
                # Stage 3: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹åŒ–
                if ($Stage -in @("DisableAccounts", "All")) {
                    Update-MgUser -UserId $student.Id -AccountEnabled $false
                    
                    # å’æ¥­ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®ç§»å‹•
                    $graduatesGroup = Get-MgGroup -Filter "displayName eq 'Graduates-$GraduationYear'" -ErrorAction SilentlyContinue
                    if (-not $graduatesGroup) {
                        # å’æ¥­ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ
                        $graduatesGroup = New-MgGroup -DisplayName "Graduates-$GraduationYear" -Description "$GraduationYear å¹´åº¦å’æ¥­ç”Ÿ" -SecurityEnabled $true
                        Write-Host "  ğŸ“ å’æ¥­ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ: Graduates-$GraduationYear" -ForegroundColor Yellow
                    }
                    
                    New-MgGroupMember -GroupId $graduatesGroup.Id -DirectoryObjectId $student.Id -ErrorAction SilentlyContinue
                    $processResults.AccountsDisabled += $student.UserPrincipalName
                    Write-Host "  âœ“ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹åŒ–ãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•å®Œäº†" -ForegroundColor Green
                }
                
                # å­¦å¹´å±æ€§ã®æ›´æ–°
                Update-MgUser -UserId $student.Id -ExtensionAttribute1 "Graduate-$GraduationYear"
                
            } catch {
                $errorInfo = @{
                    UserPrincipalName = $student.UserPrincipalName
                    Error = $_.Exception.Message
                    Stage = $Stage
                }
                $processResults.Errors += $errorInfo
                Write-Host "  âŒ å‡¦ç†å¤±æ•—: $($_.Exception.Message)" -ForegroundColor Red
            }
        }
        
        # å‡¦ç†çµæœã‚µãƒãƒªãƒ¼
        Write-Host "`n=== å’æ¥­ç”Ÿå‡¦ç†çµæœ ===" -ForegroundColor Magenta
        Write-Host "ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰Šé™¤: $($processResults.LicenseRemoved.Count)å" -ForegroundColor Green
        Write-Host "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹åŒ–: $($processResults.AccountsDisabled.Count)å" -ForegroundColor Green
        Write-Host "ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–: $($processResults.DataArchived.Count)å" -ForegroundColor Green
        Write-Host "ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: $($processResults.Errors.Count)ä»¶" -ForegroundColor Red
        
        if ($processResults.Errors.Count -gt 0) {
            Write-Host "`nã‚¨ãƒ©ãƒ¼è©³ç´°:" -ForegroundColor Red
            $processResults.Errors | ForEach-Object {
                Write-Host "  - $($_.UserPrincipalName): $($_.Error)" -ForegroundColor Red
            }
        }
        
        return $processResults
        
    } catch {
        Write-Error "å’æ¥­ç”Ÿå‡¦ç†å¤±æ•—: $($_.Exception.Message)"
    }
}
```

#### Phase 3: æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆãƒ»é€²ç´šå‡¦ç†ï¼ˆ4æœˆä¸Šæ—¬ï¼‰

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
æ–°å¹´åº¦ã®çµ„ç¹”æ§‹é€ ã«åŸºã¥ã„ã¦ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä¸€æ‹¬ä½œæˆã—ã€æ—¢å­˜å­¦ç”Ÿã®é€²ç´šå‡¦ç†ã‚’è‡ªå‹•å®Ÿè¡Œã—ã¾ã™ã€‚æ–°å…¥ç”Ÿå—ã‘å…¥ã‚Œã¨ã‚¯ãƒ©ã‚¹ç·¨æˆã€æ•™è·å“¡ã®æ‹…å½“å¤‰æ›´ã‚’åŠ¹ç‡çš„ã«å‡¦ç†ã—ã€æ–°å¹´åº¦é–‹å§‹ã¨åŒæ™‚ã«å…¨ã‚·ã‚¹ãƒ†ãƒ ãŒåˆ©ç”¨å¯èƒ½ãªçŠ¶æ…‹ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªæ–°å¹´åº¦å‡¦ç†
Start-NewAcademicYear -NewYear 2025 -ClassStructure "A,B,C" -CreateTeamsClasses

# ã‚«ã‚¹ã‚¿ãƒ æ§‹æˆã§ã®æ–°å¹´åº¦é–‹å§‹
$classConfig = @{
    Grade1 = @("A", "B", "C", "D")
    Grade2 = @("A", "B", "C")
    Grade3 = @("A", "B")
}
Start-NewAcademicYear -NewYear 2025 -CustomClassStructure $classConfig

# SDSãƒ‡ãƒ¼ã‚¿é€£æºä»˜ãå‡¦ç†
Start-NewAcademicYear -NewYear 2025 -ImportFromSDS -SDSDataPath "C:\SDS\2025"
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-NewYear`: æ–°å¹´åº¦
- `-ClassStructure`: ã‚¯ãƒ©ã‚¹æ§‹æˆï¼ˆç°¡æ˜“æŒ‡å®šï¼‰
- `-CustomClassStructure`: ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹æ§‹æˆ
- `-CreateTeamsClasses`: Teams ã‚¯ãƒ©ã‚¹è‡ªå‹•ä½œæˆ
- `-ImportFromSDS`: School Data Sync ãƒ‡ãƒ¼ã‚¿é€£æº
- `-SDSDataPath`: SDS ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

```powershell
function Start-NewAcademicYear {
    param(
        [int]$NewYear = (Get-Date).Year,
        [string]$ClassStructure = "A,B,C",
        [hashtable]$CustomClassStructure,
        [switch]$CreateTeamsClasses,
        [switch]$ImportFromSDS,
        [string]$SDSDataPath
    )
    
    Write-Host "=== æ–°å¹´åº¦é–‹å§‹å‡¦ç† ===" -ForegroundColor Magenta
    Write-Host "æ–°å¹´åº¦: $NewYear" -ForegroundColor Cyan
    
    $creationResults = @{
        GroupsCreated = @()
        StudentsPromoted = @()
        TeamsClassesCreated = @()
        Errors = @()
    }
    
    try {
        # Step 1: æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ ã®ä½œæˆ
        Write-Host "`nğŸ“ æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ ä½œæˆä¸­..." -ForegroundColor Yellow
        
        $classStructureToUse = if ($CustomClassStructure) {
            $CustomClassStructure
        } else {
            $classes = $ClassStructure -split ','
            @{
                Grade1 = $classes
                Grade2 = $classes
                Grade3 = $classes
            }
        }
        
        foreach ($grade in $classStructureToUse.Keys) {
            foreach ($class in $classStructureToUse[$grade]) {
                $groupName = "$NewYear-$grade-Class$class"
                
                try {
                    # Microsoft 365 ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ
                    $newGroup = New-MgGroup -DisplayName $groupName -Description "$NewYear å¹´åº¦ $grade $class çµ„" -GroupTypes @("Unified") -MailEnabled $true -SecurityEnabled $false -MailNickname ($groupName -replace '[^a-zA-Z0-9]', '').ToLower()
                    
                    $creationResults.GroupsCreated += @{
                        GroupName = $groupName
                        GroupId = $newGroup.Id
                        Type = "ClassGroup"
                    }
                    
                    Write-Host "  âœ“ ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ: $groupName" -ForegroundColor Green
                    
                    # Teams ã‚¯ãƒ©ã‚¹ã®ä½œæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
                    if ($CreateTeamsClasses) {
                        # Teams ã‚¯ãƒ©ã‚¹ä½œæˆã®ãŸã‚ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨
                        # æ³¨: å®Ÿéš›ã®Teamsä½œæˆã«ã¯Microsoft Graph Educationã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½¿ç”¨
                        $teamsInfo = @{
                            GroupId = $newGroup.Id
                            ClassName = $groupName
                            Subject = "ä¸€èˆ¬æˆæ¥­"
                        }
                        $creationResults.TeamsClassesCreated += $teamsInfo
                        Write-Host "  ğŸ“š Teams ã‚¯ãƒ©ã‚¹ä½œæˆäºˆå®š: $groupName" -ForegroundColor Cyan
                    }
                    
                } catch {
                    $creationResults.Errors += @{
                        Operation = "GroupCreation"
                        Target = $groupName
                        Error = $_.Exception.Message
                    }
                    Write-Host "  âŒ ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆå¤±æ•—: $groupName - $($_.Exception.Message)" -ForegroundColor Red
                }
            }
        }
        
        # Step 2: æ—¢å­˜å­¦ç”Ÿã®é€²ç´šå‡¦ç†
        Write-Host "`nğŸ“ˆ å­¦ç”Ÿé€²ç´šå‡¦ç†ä¸­..." -ForegroundColor Yellow
        
        # 1å¹´ç”Ÿâ†’2å¹´ç”Ÿ
        $grade1Students = Get-MgUser -Filter "extensionAttribute1 eq 'Grade1' and userType eq 'Member'" -All
        foreach ($student in $grade1Students) {
            try {
                Update-MgUser -UserId $student.Id -ExtensionAttribute1 "Grade2"
                
                # æ–°ã—ã„å­¦å¹´ã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®è¿½åŠ ã¯åˆ¥é€”ã‚¯ãƒ©ã‚¹åˆ†ã‘å¾Œã«å®Ÿè¡Œ
                $creationResults.StudentsPromoted += @{
                    UserPrincipalName = $student.UserPrincipalName
                    From = "Grade1"
                    To = "Grade2"
                }
                Write-Host "  âœ“ é€²ç´šå‡¦ç†: $($student.UserPrincipalName) (1å¹´â†’2å¹´)" -ForegroundColor Green
            } catch {
                $creationResults.Errors += @{
                    Operation = "StudentPromotion"
                    Target = $student.UserPrincipalName
                    Error = $_.Exception.Message
                }
            }
        }
        
        # 2å¹´ç”Ÿâ†’3å¹´ç”Ÿ
        $grade2Students = Get-MgUser -Filter "extensionAttribute1 eq 'Grade2' and userType eq 'Member'" -All
        foreach ($student in $grade2Students) {
            try {
                Update-MgUser -UserId $student.Id -ExtensionAttribute1 "Grade3"
                
                $creationResults.StudentsPromoted += @{
                    UserPrincipalName = $student.UserPrincipalName
                    From = "Grade2"
                    To = "Grade3"
                }
                Write-Host "  âœ“ é€²ç´šå‡¦ç†: $($student.UserPrincipalName) (2å¹´â†’3å¹´)" -ForegroundColor Green
            } catch {
                $creationResults.Errors += @{
                    Operation = "StudentPromotion"
                    Target = $student.UserPrincipalName
                    Error = $_.Exception.Message
                }
            }
        }
        
        # Step 3: SDS ãƒ‡ãƒ¼ã‚¿é€£æºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        if ($ImportFromSDS -and $SDSDataPath) {
            Write-Host "`nğŸ”„ School Data Sync ãƒ‡ãƒ¼ã‚¿é€£æºä¸­..." -ForegroundColor Yellow
            
            try {
                # SDS CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
                $sdsFiles = @{
                    Students = "$SDSDataPath\Student.csv"
                    Teachers = "$SDSDataPath\Teacher.csv"
                    Sections = "$SDSDataPath\Section.csv"
                    Enrollments = "$SDSDataPath\StudentEnrollment.csv"
                }
                
                foreach ($file in $sdsFiles.Values) {
                    if (-not (Test-Path $file)) {
                        Write-Warning "SDSãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $file"
                        continue
                    }
                }
                
                # æ–°å…¥ç”Ÿãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
                $newStudents = Import-Csv $sdsFiles.Students -Encoding UTF8
                $newStudents | Where-Object { $_.Grade -eq "1" } | ForEach-Object {
                    # æ–°å…¥ç”Ÿã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆå‡¦ç†ï¼ˆåˆ¥é–¢æ•°ã§å®Ÿè£…ï¼‰
                    Write-Host "  ğŸ“ æ–°å…¥ç”Ÿç™»éŒ²æº–å‚™: $($_.Username)" -ForegroundColor Cyan
                }
                
                Write-Host "  âœ“ SDS ãƒ‡ãƒ¼ã‚¿é€£æºå®Œäº†" -ForegroundColor Green
                
            } catch {
                Write-Host "  âŒ SDS ãƒ‡ãƒ¼ã‚¿é€£æºå¤±æ•—: $($_.Exception.Message)" -ForegroundColor Red
            }
        }
        
        # Step 4: å¹´åº¦ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®æ•´ç†
        Write-Host "`nğŸ“¦ å‰å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¸­..." -ForegroundColor Yellow
        
        $previousYear = $NewYear - 1
        $previousYearGroups = Get-MgGroup -Filter "startswith(displayName, '$previousYear-')" -All
        
        foreach ($group in $previousYearGroups) {
            try {
                # ã‚°ãƒ«ãƒ¼ãƒ—åã«"Archive"ã‚’è¿½åŠ 
                $newDisplayName = "Archive-$($group.DisplayName)"
                Update-MgGroup -GroupId $group.Id -DisplayName $newDisplayName
                Write-Host "  ğŸ“ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–: $($group.DisplayName) â†’ $newDisplayName" -ForegroundColor Gray
            } catch {
                Write-Host "  âš ï¸ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å¤±æ•—: $($group.DisplayName)" -ForegroundColor Yellow
            }
        }
        
        # å‡¦ç†çµæœã‚µãƒãƒªãƒ¼
        Write-Host "`n=== æ–°å¹´åº¦é–‹å§‹å‡¦ç†çµæœ ===" -ForegroundColor Magenta
        Write-Host "ä½œæˆã‚°ãƒ«ãƒ¼ãƒ—æ•°: $($creationResults.GroupsCreated.Count)" -ForegroundColor Green
        Write-Host "é€²ç´šå‡¦ç†å­¦ç”Ÿæ•°: $($creationResults.StudentsPromoted.Count)" -ForegroundColor Green
        Write-Host "Teams ã‚¯ãƒ©ã‚¹ä½œæˆäºˆå®š: $($creationResults.TeamsClassesCreated.Count)" -ForegroundColor Cyan
        Write-Host "ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: $($creationResults.Errors.Count)ä»¶" -ForegroundColor Red
        
        return $creationResults
        
    } catch {
        Write-Error "æ–°å¹´åº¦é–‹å§‹å‡¦ç†å¤±æ•—: $($_.Exception.Message)"
    }
}
```

### 3. ç¶™ç¶šçš„ãªå¹´æ¬¡ä¿å®ˆ

#### å®šæœŸçš„ãªã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

**ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„**
å¹´é–“ã‚’é€šã˜ã¦ã‚°ãƒ«ãƒ¼ãƒ—ã®å¥å…¨æ€§ã‚’ç¶­æŒã—ã€ä½¿ç”¨ã•ã‚Œãªããªã£ãŸã‚°ãƒ«ãƒ¼ãƒ—ã®ç‰¹å®šãƒ»æ•´ç†ã€ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®æ­£ç¢ºæ€§ç¢ºèªã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã®æ—©æœŸç™ºè¦‹ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚åŠ¹ç‡çš„ãªé‹ç”¨ã¨æ­£ç¢ºãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ç¶™ç¶šçš„ã«ç¢ºä¿ã—ã¾ã™ã€‚

**ğŸ“ Usage**
```powershell
# åŸºæœ¬çš„ãªå®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
Invoke-GroupMaintenance -MaintenanceType "All" -OutputReport "C:\reports\group_maintenance.xlsx"

# ç‰¹å®šç¨®é¡ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®ã¿
Invoke-GroupMaintenance -MaintenanceType "InactiveGroups" -InactivityThreshold 60

# è©³ç´°åˆ†æä»˜ããƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
Invoke-GroupMaintenance -MaintenanceType "All" -DetailedAnalysis -AutoCleanup -ApprovalRequired
```

**âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
- `-MaintenanceType`: ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç¨®åˆ¥ï¼ˆAll/InactiveGroups/DuplicateMembers/OrphanedGroupsï¼‰
- `-InactivityThreshold`: éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åˆ¤å®šæ—¥æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ90æ—¥ï¼‰
- `-DetailedAnalysis`: è©³ç´°åˆ†æå®Ÿè¡Œ
- `-AutoCleanup`: è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆæ‰¿èªå¾Œï¼‰
- `-ApprovalRequired`: å¤‰æ›´å‰ã®æ‰¿èªè¦æ±‚

```powershell
function Invoke-GroupMaintenance {
    param(
        [ValidateSet("All", "InactiveGroups", "DuplicateMembers", "OrphanedGroups", "SizeAnalysis")]
        [string]$MaintenanceType = "All",
        [int]$InactivityThreshold = 90,
        [switch]$DetailedAnalysis,
        [switch]$AutoCleanup,
        [switch]$ApprovalRequired,
        [string]$OutputReport
    )
    
    Write-Host "=== ã‚°ãƒ«ãƒ¼ãƒ—å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹é–‹å§‹ ===" -ForegroundColor Magenta
    Write-Host "ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç¨®åˆ¥: $MaintenanceType" -ForegroundColor Cyan
    
    $maintenanceResults = @{
        InactiveGroups = @()
        DuplicateMembers = @()
        OrphanedGroups = @()
        SizeAnalysis = @()
        ActionsRecommended = @()
        ActionsExecuted = @()
    }
    
    try {
        # 1. éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã®æ¤œå‡º
        if ($MaintenanceType -in @("All", "InactiveGroups")) {
            Write-Host "`nğŸ” éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—æ¤œå‡ºä¸­..." -ForegroundColor Yellow
            
            $allGroups = Get-MgGroup -All
            $thresholdDate = (Get-Date).AddDays(-$InactivityThreshold)
            
            foreach ($group in $allGroups) {
                try {
                    # ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£åˆ†æ
                    $members = Get-MgGroupMember -GroupId $group.Id -All
                    $lastActivity = $null
                    
                    # Microsoft 365 ã‚°ãƒ«ãƒ¼ãƒ—ã®å ´åˆã€Teamsæ´»å‹•ã‚„SharePointæ´»å‹•ã‚’ãƒã‚§ãƒƒã‚¯
                    if ($group.GroupTypes -contains "Unified") {
                        # æ³¨: å®Ÿéš›ã®å®Ÿè£…ã§ã¯ Microsoft Graph Activity API ã‚’ä½¿ç”¨
                        $lastActivity = $group.CreatedDateTime # ç°¡ç•¥åŒ–
                    }
                    
                    if ($lastActivity -and [datetime]$lastActivity -lt $thresholdDate) {
                        $groupInfo = @{
                            GroupName = $group.DisplayName
                            GroupId = $group.Id
                            CreatedDate = $group.CreatedDateTime
                            LastActivity = $lastActivity
                            MemberCount = $members.Count
                            GroupType = if ($group.GroupTypes -contains "Unified") { "Microsoft365" } else { "Security" }
                            Recommendation = "ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ç¢ºèªãƒ»å¿…è¦ã«å¿œã˜ã¦ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–"
                        }
                        $maintenanceResults.InactiveGroups += $groupInfo
                    }
                } catch {
                    Write-Warning "ã‚°ãƒ«ãƒ¼ãƒ—åˆ†æå¤±æ•—: $($group.DisplayName)"
                }
            }
            
            Write-Host "  ğŸ“Š éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—: $($maintenanceResults.InactiveGroups.Count)ä»¶" -ForegroundColor Yellow
        }
        
        # 2. é‡è¤‡ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®æ¤œå‡º
        if ($MaintenanceType -in @("All", "DuplicateMembers")) {
            Write-Host "`nğŸ” é‡è¤‡ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—æ¤œå‡ºä¸­..." -ForegroundColor Yellow
            
            $allUsers = Get-MgUser -All
            
            foreach ($user in $allUsers) {
                try {
                    $userGroups = Get-MgUserMemberOf -UserId $user.Id -All
                    $groupNames = $userGroups | ForEach-Object { $_.AdditionalProperties.displayName }
                    
                    # é¡ä¼¼ã‚°ãƒ«ãƒ¼ãƒ—åã§ã®é‡è¤‡æ¤œå‡ºï¼ˆä¾‹ï¼š2024-Grade1-ClassA ã¨ 2025-Grade1-ClassAï¼‰
                    $duplicatePatterns = $groupNames | Group-Object { ($_ -split '-')[1..2] -join '-' } | Where-Object { $_.Count -gt 1 }
                    
                    foreach ($pattern in $duplicatePatterns) {
                        $duplicateInfo = @{
                            UserPrincipalName = $user.UserPrincipalName
                            DuplicateGroups = $pattern.Group
                            Pattern = $pattern.Name
                            Recommendation = "æœ€æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—ã®ã¿ã«æ•´ç†"
                        }
                        $maintenanceResults.DuplicateMembers += $duplicateInfo
                    }
                } catch {
                    Write-Warning "ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ†æå¤±æ•—: $($user.UserPrincipalName)"
                }
            }
            
            Write-Host "  ğŸ“Š é‡è¤‡ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—: $($maintenanceResults.DuplicateMembers.Count)ä»¶" -ForegroundColor Yellow
        }
        
        # 3. æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ—ã®æ¤œå‡º
        if ($MaintenanceType -in @("All", "OrphanedGroups")) {
            Write-Host "`nğŸ” æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ—æ¤œå‡ºä¸­..." -ForegroundColor Yellow
            
            $allGroups = Get-MgGroup -All
            
            foreach ($group in $allGroups) {
                try {
                    $owners = Get-MgGroupOwner -GroupId $group.Id -ErrorAction SilentlyContinue
                    
                    if ($owners.Count -eq 0) {
                        $orphanInfo = @{
                            GroupName = $group.DisplayName
                            GroupId = $group.Id
                            MemberCount = (Get-MgGroupMember -GroupId $group.Id).Count
                            CreatedDate = $group.CreatedDateTime
                            Recommendation = "æ‰€æœ‰è€…ã®æŒ‡å®šã¾ãŸã¯ç®¡ç†è€…æ‰¿èª"
                        }
                        $maintenanceResults.OrphanedGroups += $orphanInfo
                    }
                } catch {
                    Write-Warning "æ‰€æœ‰è€…ç¢ºèªå¤±æ•—: $($group.DisplayName)"
                }
            }
            
            Write-Host "  ğŸ“Š æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ—: $($maintenanceResults.OrphanedGroups.Count)ä»¶" -ForegroundColor Yellow
        }
        
        # 4. ã‚°ãƒ«ãƒ¼ãƒ—ã‚µã‚¤ã‚ºåˆ†æ
        if ($MaintenanceType -in @("All", "SizeAnalysis")) {
            Write-Host "`nğŸ“ ã‚°ãƒ«ãƒ¼ãƒ—ã‚µã‚¤ã‚ºåˆ†æä¸­..." -ForegroundColor Yellow
            
            $allGroups = Get-MgGroup -All
            
            foreach ($group in $allGroups) {
                try {
                    $memberCount = (Get-MgGroupMember -GroupId $group.Id).Count
                    
                    $sizeCategory = switch ($memberCount) {
                        { $_ -eq 0 } { "Empty" }
                        { $_ -le 5 } { "Small" }
                        { $_ -le 50 } { "Medium" }
                        { $_ -le 200 } { "Large" }
                        default { "ExtraLarge" }
                    }
                    
                    $sizeInfo = @{
                        GroupName = $group.DisplayName
                        MemberCount = $memberCount
                        SizeCategory = $sizeCategory
                        GroupType = if ($group.GroupTypes -contains "Unified") { "Microsoft365" } else { "Security" }
                        CreatedDate = $group.CreatedDateTime
                    }
                    
                    if ($memberCount -eq 0) {
                        $sizeInfo.Recommendation = "ç©ºã‚°ãƒ«ãƒ¼ãƒ—ã®å‰Šé™¤æ¤œè¨"
                    } elseif ($memberCount -gt 200) {
                        $sizeInfo.Recommendation = "å¤§è¦æ¨¡ã‚°ãƒ«ãƒ¼ãƒ—ã®åˆ†å‰²æ¤œè¨"
                    }
                    
                    $maintenanceResults.SizeAnalysis += $sizeInfo
                } catch {
                    Write-Warning "ã‚µã‚¤ã‚ºåˆ†æå¤±æ•—: $($group.DisplayName)"
                }
            }
            
            Write-Host "  ğŸ“Š ã‚°ãƒ«ãƒ¼ãƒ—ã‚µã‚¤ã‚ºåˆ†æå®Œäº†" -ForegroundColor Green
        }
        
        # 5. æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆ
        $recommendedActions = @()
        
        if ($maintenanceResults.InactiveGroups.Count -gt 0) {
            $recommendedActions += "éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ«ãƒ¼ãƒ— $($maintenanceResults.InactiveGroups.Count)ä»¶ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¤œè¨"
        }
        
        if ($maintenanceResults.DuplicateMembers.Count -gt 0) {
            $recommendedActions += "é‡è¤‡ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ— $($maintenanceResults.DuplicateMembers.Count)ä»¶ã®æ•´ç†"
        }
        
        if ($maintenanceResults.OrphanedGroups.Count -gt 0) {
            $recommendedActions += "æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ— $($maintenanceResults.OrphanedGroups.Count)ä»¶ã®æ‰€æœ‰è€…æŒ‡å®š"
        }
        
        $emptyGroups = $maintenanceResults.SizeAnalysis | Where-Object { $_.SizeCategory -eq "Empty" }
        if ($emptyGroups.Count -gt 0) {
            $recommendedActions += "ç©ºã‚°ãƒ«ãƒ¼ãƒ— $($emptyGroups.Count)ä»¶ã®å‰Šé™¤æ¤œè¨"
        }
        
        $maintenanceResults.ActionsRecommended = $recommendedActions
        
        # 6. è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        if ($AutoCleanup) {
            Write-Host "`nğŸ§¹ è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œä¸­..." -ForegroundColor Yellow
            
            if ($ApprovalRequired) {
                Write-Host "æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:" -ForegroundColor Cyan
                $recommendedActions | ForEach-Object { Write-Host "  - $_" -ForegroundColor White }
                $approval = Read-Host "`nè‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ (yes/no)"
                
                if ($approval -ne "yes") {
                    Write-Host "è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ" -ForegroundColor Yellow
                    return $maintenanceResults
                }
            }
            
            # ç©ºã‚°ãƒ«ãƒ¼ãƒ—ã®å‰Šé™¤
            foreach ($emptyGroup in $emptyGroups) {
                try {
                    Remove-MgGroup -GroupId $emptyGroup.GroupId -Confirm:$false
                    $maintenanceResults.ActionsExecuted += "ç©ºã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤: $($emptyGroup.GroupName)"
                    Write-Host "  âœ“ ç©ºã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤: $($emptyGroup.GroupName)" -ForegroundColor Green
                } catch {
                    Write-Host "  âŒ å‰Šé™¤å¤±æ•—: $($emptyGroup.GroupName)" -ForegroundColor Red
                }
            }
        }
        
        # 7. ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›
        if ($OutputReport) {
            $maintenanceResults | ConvertTo-Json -Depth 10 | Out-File "$OutputReport.json" -Encoding UTF8
            Write-Host "`nğŸ“„ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›: $OutputReport.json" -ForegroundColor Green
        }
        
        # ã‚µãƒãƒªãƒ¼è¡¨ç¤º
        Write-Host "`n=== ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çµæœã‚µãƒãƒªãƒ¼ ===" -ForegroundColor Magenta
        Write-Host "éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—: $($maintenanceResults.InactiveGroups.Count)ä»¶" -ForegroundColor Yellow
        Write-Host "é‡è¤‡ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—: $($maintenanceResults.DuplicateMembers.Count)ä»¶" -ForegroundColor Yellow
        Write-Host "æ‰€æœ‰è€…ä¸åœ¨ã‚°ãƒ«ãƒ¼ãƒ—: $($maintenanceResults.OrphanedGroups.Count)ä»¶" -ForegroundColor Yellow
        Write-Host "ç©ºã‚°ãƒ«ãƒ¼ãƒ—: $(($maintenanceResults.SizeAnalysis | Where-Object { $_.SizeCategory -eq 'Empty' }).Count)ä»¶" -ForegroundColor Yellow
        Write-Host "å®Ÿè¡Œã•ã‚ŒãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³: $($maintenanceResults.ActionsExecuted.Count)ä»¶" -ForegroundColor Green
        
        return $maintenanceResults
        
    } catch {
        Write-Error "ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å¤±æ•—: $($_.Exception.Message)"
    }
}
```

---

## ğŸ§ª å®Ÿç¿’æ¼”ç¿’: å­¦æ ¡é‹å–¶ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### æ¼”ç¿’1: æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ ã®è¨­è¨ˆï¼ˆ30åˆ†ï¼‰

#### ã‚·ãƒŠãƒªã‚ªè¨­å®š

```markdown
ğŸ« æ¶ç©ºã®ã€Œã‚µãƒ³ãƒ—ãƒ«ä¸­å­¦æ ¡ã€æ–°å¹´åº¦æº–å‚™

**å­¦æ ¡æ¦‚è¦**:
- å„å­¦å¹´3ã‚¯ãƒ©ã‚¹ï¼ˆAçµ„ã€Bçµ„ã€Cçµ„ï¼‰
- å…¨æ ¡ç”Ÿå¾’æ•°: ç´„270åï¼ˆå„å­¦å¹´90åï¼‰
- æ•™è·å“¡æ•°: 45åï¼ˆæ•™å“¡35åã€äº‹å‹™è·å“¡10åï¼‰
- éƒ¨æ´»å‹•: 10éƒ¨æ´»ï¼ˆæ–‡åŒ–éƒ¨5ã€é‹å‹•éƒ¨5ï¼‰

**çµ„ç¹”æ§‹é€ **:
- æ•™å‹™éƒ¨ï¼ˆæ•™å‹™ä¸»ä»»ã€å­¦å¹´ä¸»ä»»Ã—3ï¼‰
- ç”Ÿå¾’æŒ‡å°éƒ¨ï¼ˆç”Ÿå¾’æŒ‡å°ä¸»äº‹ã€å„å­¦å¹´æ‹…å½“ï¼‰
- é€²è·¯æŒ‡å°éƒ¨ï¼ˆé€²è·¯æŒ‡å°ä¸»äº‹ã€3å¹´æ‹…å½“ï¼‰
- äº‹å‹™éƒ¨ï¼ˆäº‹å‹™é•·ã€åº¶å‹™ã€çµŒç†ã€æ–½è¨­ç®¡ç†ï¼‰

**å¹´æ¬¡æ›´æ–°èª²é¡Œ**:
- 2024å¹´åº¦3å¹´ç”Ÿ90åã®å’æ¥­å‡¦ç†
- 1ãƒ»2å¹´ç”Ÿã®é€²ç´šã¨ã‚¯ãƒ©ã‚¹æ›¿ãˆ
- æ–°å…¥ç”Ÿ90åã®å—ã‘å…¥ã‚Œæº–å‚™
- æ•™è·å“¡5åã®ç•°å‹•ãƒ»æ–°æ¡ç”¨3å
```

#### æ¼”ç¿’æ‰‹é †

1. **ç¾çŠ¶åˆ†æã¨ã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆ**
   ```powershell
   # ç¾åœ¨ã®ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ ã®åˆ†æ
   Analyze-CurrentGroupStructure -School "Sample-MiddleSchool" -AcademicYear 2024
   
   # æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆã®ç­–å®š
   Design-NewAcademicYearStructure -NewYear 2025 -StudentCount 270 -ClassesPerGrade 3
   ```

2. **æ®µéšçš„ç§»è¡Œè¨ˆç”»ã®ç­–å®š**
   ```powershell
   # ç§»è¡Œè¨ˆç”»ã®ä½œæˆ
   Create-TransitionPlan -FromYear 2024 -ToYear 2025 -GraduatingStudents 90 -NewStudents 90
   ```

3. **ãƒ†ã‚¹ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã§ã®æ¤œè¨¼**
   ```powershell
   # ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
   Test-GroupStructure -TestMode -SampleSize 10
   ```

### æ¼”ç¿’2: å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ãƒ«ãƒ¼ãƒ«ã®è¨­è¨ˆï¼ˆ25åˆ†ï¼‰

#### è¨­è¨ˆè¦ä»¶

```markdown
ğŸ¯ å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—è¦ä»¶

**å­¦å¹´åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—**:
- å±æ€§: extensionAttribute1 (Grade1, Grade2, Grade3)
- å¯¾è±¡: å­¦ç”Ÿã®ã¿ï¼ˆuserType = Memberï¼‰

**è·ç¨®åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—**:
- æ•™å“¡: jobTitle ã« "æ•™" ã‚’å«ã‚€
- äº‹å‹™è·å“¡: department = "äº‹å‹™éƒ¨"
- ç®¡ç†è·: jobTitle ã« "ä¸»ä»»" ã¾ãŸã¯ "æ ¡é•·" ã‚’å«ã‚€

**éƒ¨æ´»å‹•ã‚°ãƒ«ãƒ¼ãƒ—**:
- å±æ€§: extensionAttribute2 (éƒ¨æ´»å‹•ã‚³ãƒ¼ãƒ‰)
- é¡§å•: jobTitle + extensionAttribute3 (é¡§å•ãƒ•ãƒ©ã‚°)

**ç‰¹åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—**:
- æ–°å…¥ç”Ÿ: extensionAttribute1 = "Grade1" AND createdDateTime > æ–°å¹´åº¦é–‹å§‹æ—¥
- å—é¨“ç”Ÿ: extensionAttribute1 = "Grade3" AND extensionAttribute4 = "ExamPeriod"
```

#### å®Ÿè£…æ¼”ç¿’

```powershell
# æ¼”ç¿’ç”¨å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ãƒ«ãƒ¼ãƒ«ä½œæˆ
$dynamicRules = @{
    "Grade1-Students" = "(user.extensionAttribute1 -eq 'Grade1') -and (user.userType -eq 'Member')"
    "Grade2-Students" = "(user.extensionAttribute1 -eq 'Grade2') -and (user.userType -eq 'Member')"
    "Grade3-Students" = "(user.extensionAttribute1 -eq 'Grade3') -and (user.userType -eq 'Member')"
    "All-Teachers" = "(user.jobTitle -contains 'æ•™') -and (user.userType -eq 'Member')"
    "Administrative-Staff" = "(user.department -eq 'äº‹å‹™éƒ¨')"
    "School-Administrators" = "(user.jobTitle -contains 'ä¸»ä»»') -or (user.jobTitle -contains 'æ ¡é•·')"
    "Baseball-Club" = "(user.extensionAttribute2 -eq 'Baseball')"
    "New-Students" = "(user.extensionAttribute1 -eq 'Grade1') -and (user.createdDateTime -ge '2025-04-01')"
}

# å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€æ‹¬ä½œæˆ
foreach ($groupName in $dynamicRules.Keys) {
    New-DynamicEducationGroup -GroupName $groupName -Rule $dynamicRules[$groupName] -GroupType "Security"
}
```

### æ¼”ç¿’3: å¹´æ¬¡æ›´æ–°ã®å®Œå…¨è‡ªå‹•åŒ–ï¼ˆ45åˆ†ï¼‰

#### åŒ…æ‹¬çš„ãªå¹´æ¬¡æ›´æ–°ã‚·ãƒŠãƒªã‚ª

```markdown
ğŸ”„ å®Œå…¨ãªå¹´æ¬¡æ›´æ–°ãƒ—ãƒ­ã‚»ã‚¹

**Phase 1: äº‹å‰æº–å‚™ï¼ˆ2æœˆï¼‰**
1. ç¾çŠ¶ãƒ‡ãƒ¼ã‚¿ã®åŒ…æ‹¬çš„åˆ†æ
2. å’æ¥­äºˆå®šè€…ãƒ»é€²ç´šäºˆå®šè€…ã®ç‰¹å®š
3. æ–°å¹´åº¦çµ„ç¹”æ§‹é€ ã®ç¢ºå®š
4. ç§»è¡Œè¨ˆç”»ã®ç­–å®šãƒ»æ‰¿èª

**Phase 2: å’æ¥­ç”Ÿå‡¦ç†ï¼ˆ3æœˆï¼‰**
1. ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
2. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰Šé™¤ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰
3. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹åŒ–ãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•
4. å’æ¥­ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ

**Phase 3: æ–°å¹´åº¦é–‹å§‹ï¼ˆ4æœˆï¼‰**
1. æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ ã®ä½œæˆ
2. æ—¢å­˜å­¦ç”Ÿã®é€²ç´šå‡¦ç†
3. æ–°å…¥ç”Ÿã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆãƒ»é…å±
4. æ•™è·å“¡ç•°å‹•åæ˜ 

**Phase 4: æ¤œè¨¼ãƒ»æœ€é©åŒ–ï¼ˆ4æœˆä¸­æ—¬ï¼‰**
1. å…¨ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®æ¤œè¨¼
2. ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®ç¢ºèª
3. ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œç¢ºèª
4. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†ãƒ»æ”¹å–„
```

#### ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè£…

```powershell
function Complete-AnnualUpdate {
    param(
        [int]$CurrentYear = 2024,
        [int]$NewYear = 2025,
        [switch]$ExecutePhase1,    # äº‹å‰æº–å‚™
        [switch]$ExecutePhase2,    # å’æ¥­ç”Ÿå‡¦ç†
        [switch]$ExecutePhase3,    # æ–°å¹´åº¦é–‹å§‹
        [switch]$ExecutePhase4,    # æ¤œè¨¼ãƒ»æœ€é©åŒ–
        [switch]$ExecuteAll,       # å…¨Phaseå®Ÿè¡Œ
        [string]$ConfigPath = "C:\Config\AnnualUpdate.json"
    )
    
    if ($ExecuteAll) {
        $ExecutePhase1 = $ExecutePhase2 = $ExecutePhase3 = $ExecutePhase4 = $true
    }
    
    Write-Host "=== å¹´æ¬¡æ›´æ–°ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹é–‹å§‹ ===" -ForegroundColor Magenta
    Write-Host "$CurrentYear â†’ $NewYear å¹´åº¦æ›´æ–°" -ForegroundColor Cyan
    
    $overallResults = @{
        Phase1Results = $null
        Phase2Results = $null
        Phase3Results = $null
        Phase4Results = $null
        TotalProcessingTime = $null
        OverallStatus = "NotStarted"
    }
    
    $startTime = Get-Date
    
    try {
        # Phase 1: äº‹å‰æº–å‚™ãƒ»ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
        if ($ExecutePhase1) {
            Write-Host "`nğŸ” Phase 1: äº‹å‰æº–å‚™ãƒ»ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼é–‹å§‹" -ForegroundColor Green
            $phase1Start = Get-Date
            
            $overallResults.Phase1Results = Prepare-AnnualUpdate -CurrentAcademicYear $CurrentYear -NextAcademicYear $NewYear -CheckType "All" -Detailed -IncludeRecommendations
            
            $phase1Duration = (Get-Date) - $phase1Start
            Write-Host "Phase 1 å®Œäº†æ™‚é–“: $($phase1Duration.ToString('hh\:mm\:ss'))" -ForegroundColor Green
        }
        
        # Phase 2: å’æ¥­ç”Ÿå‡¦ç†
        if ($ExecutePhase2) {
            Write-Host "`nğŸ“ Phase 2: å’æ¥­ç”Ÿå‡¦ç†é–‹å§‹" -ForegroundColor Green
            $phase2Start = Get-Date
            
            $overallResults.Phase2Results = Process-GraduatingStudents -GraduationYear $CurrentYear -Stage "All" -ArchivePeriod 180 -CreateArchive
            
            $phase2Duration = (Get-Date) - $phase2Start
            Write-Host "Phase 2 å®Œäº†æ™‚é–“: $($phase2Duration.ToString('hh\:mm\:ss'))" -ForegroundColor Green
        }
        
        # Phase 3: æ–°å¹´åº¦é–‹å§‹
        if ($ExecutePhase3) {
            Write-Host "`nğŸš€ Phase 3: æ–°å¹´åº¦é–‹å§‹å‡¦ç†" -ForegroundColor Green
            $phase3Start = Get-Date
            
            $overallResults.Phase3Results = Start-NewAcademicYear -NewYear $NewYear -ClassStructure "A,B,C" -CreateTeamsClasses -ImportFromSDS
            
            $phase3Duration = (Get-Date) - $phase3Start
            Write-Host "Phase 3 å®Œäº†æ™‚é–“: $($phase3Duration.ToString('hh\:mm\:ss'))" -ForegroundColor Green
        }
        
        # Phase 4: æ¤œè¨¼ãƒ»æœ€é©åŒ–
        if ($ExecutePhase4) {
            Write-Host "`nâœ… Phase 4: æ¤œè¨¼ãƒ»æœ€é©åŒ–é–‹å§‹" -ForegroundColor Green
            $phase4Start = Get-Date
            
            $overallResults.Phase4Results = Invoke-GroupMaintenance -MaintenanceType "All" -DetailedAnalysis
            
            # çµ±åˆæ¤œè¨¼
            Write-Host "çµ±åˆæ¤œè¨¼å®Ÿè¡Œä¸­..." -ForegroundColor Yellow
            $verificationResults = Test-AnnualUpdateIntegrity -TargetYear $NewYear
            $overallResults.Phase4Results.VerificationResults = $verificationResults
            
            $phase4Duration = (Get-Date) - $phase4Start
            Write-Host "Phase 4 å®Œäº†æ™‚é–“: $($phase4Duration.ToString('hh\:mm\:ss'))" -ForegroundColor Green
        }
        
        $overallResults.TotalProcessingTime = (Get-Date) - $startTime
        $overallResults.OverallStatus = "Completed"
        
        # æœ€çµ‚çµæœã‚µãƒãƒªãƒ¼
        Write-Host "`n=== å¹´æ¬¡æ›´æ–°å®Œäº†ã‚µãƒãƒªãƒ¼ ===" -ForegroundColor Magenta
        Write-Host "ç·å‡¦ç†æ™‚é–“: $($overallResults.TotalProcessingTime.ToString('hh\:mm\:ss'))" -ForegroundColor Cyan
        
        if ($overallResults.Phase1Results) {
            Write-Host "Phase 1 - å’æ¥­äºˆå®šè€…: $($overallResults.Phase1Results.GraduatingStudents.Count)å" -ForegroundColor White
            Write-Host "Phase 1 - é€²ç´šäºˆå®šè€…: $($overallResults.Phase1Results.PromotingStudents.Count)å" -ForegroundColor White
        }
        
        if ($overallResults.Phase2Results) {
            Write-Host "Phase 2 - ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰Šé™¤: $($overallResults.Phase2Results.LicenseRemoved.Count)å" -ForegroundColor White
            Write-Host "Phase 2 - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹åŒ–: $($overallResults.Phase2Results.AccountsDisabled.Count)å" -ForegroundColor White
        }
        
        if ($overallResults.Phase3Results) {
            Write-Host "Phase 3 - æ–°è¦ã‚°ãƒ«ãƒ¼ãƒ—: $($overallResults.Phase3Results.GroupsCreated.Count)ä»¶" -ForegroundColor White
            Write-Host "Phase 3 - é€²ç´šå‡¦ç†: $($overallResults.Phase3Results.StudentsPromoted.Count)å" -ForegroundColor White
        }
        
        Write-Host "`nğŸ‰ å¹´æ¬¡æ›´æ–°ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼" -ForegroundColor Green
        
        return $overallResults
        
    } catch {
        $overallResults.OverallStatus = "Failed"
        $overallResults.TotalProcessingTime = (Get-Date) - $startTime
        Write-Error "å¹´æ¬¡æ›´æ–°å‡¦ç†å¤±æ•—: $($_.Exception.Message)"
        return $overallResults
    }
}

# çµ±åˆæ¤œè¨¼ç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
function Test-AnnualUpdateIntegrity {
    param([int]$TargetYear)
    
    Write-Host "å¹´æ¬¡æ›´æ–°çµ±åˆæ¤œè¨¼å®Ÿè¡Œä¸­..." -ForegroundColor Cyan
    
    $verificationResults = @{
        GroupIntegrity = $true
        MembershipAccuracy = $true
        PermissionConsistency = $true
        DataIntegrity = $true
        Issues = @()
    }
    
    try {
        # æ–°å¹´åº¦ã‚°ãƒ«ãƒ¼ãƒ—ã®å­˜åœ¨ç¢ºèª
        $expectedGroups = @("$TargetYear-Grade1-ClassA", "$TargetYear-Grade2-ClassA", "$TargetYear-Grade3-ClassA")
        foreach ($groupName in $expectedGroups) {
            $group = Get-MgGroup -Filter "displayName eq '$groupName'" -ErrorAction SilentlyContinue
            if (-not $group) {
                $verificationResults.GroupIntegrity = $false
                $verificationResults.Issues += "å¿…è¦ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $groupName"
            }
        }
        
        # é€²ç´šå¾Œã®å­¦ç”Ÿå±æ€§ç¢ºèª
        $grade2Students = Get-MgUser -Filter "extensionAttribute1 eq 'Grade2'" -All
        $grade3Students = Get-MgUser -Filter "extensionAttribute1 eq 'Grade3'" -All
        
        if ($grade2Students.Count -eq 0 -and $grade3Students.Count -eq 0) {
            $verificationResults.MembershipAccuracy = $false
            $verificationResults.Issues += "é€²ç´šå‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™"
        }
        
        # å’æ¥­ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ã®ç¢ºèª
        $graduatesGroup = Get-MgGroup -Filter "displayName eq 'Graduates-$($TargetYear-1)'" -ErrorAction SilentlyContinue
        if (-not $graduatesGroup) {
            $verificationResults.DataIntegrity = $false
            $verificationResults.Issues += "å’æ¥­ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“"
        }
        
        Write-Host "âœ… çµ±åˆæ¤œè¨¼å®Œäº†" -ForegroundColor Green
        return $verificationResults
        
    } catch {
        $verificationResults.GroupIntegrity = $false
        $verificationResults.Issues += "æ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ: $($_.Exception.Message)"
        return $verificationResults
    }
}
```

---

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### å•é¡Œ1: å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ãŒæ›´æ–°ã•ã‚Œãªã„

**ç—‡çŠ¶**: å‹•çš„ãƒ«ãƒ¼ãƒ«è¨­å®šå¾Œã€ãƒ¡ãƒ³ãƒãƒ¼ãŒè‡ªå‹•è¿½åŠ ã•ã‚Œãªã„

**åŸå› ã¨è§£æ±ºæ–¹æ³•**:

```markdown
ğŸ”§ è¨ºæ–­æ‰‹é †

1. **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¢ºèª**
   - Microsoft 365 A3/A5 (Microsoft Entra ID Premium P1ã‚’å«ã‚€) ãŒå¿…è¦
   - ãƒ†ãƒŠãƒ³ãƒˆå…¨ä½“ã§ã®æœ‰åŠ¹åŒ–ç¢ºèª

2. **ãƒ«ãƒ¼ãƒ«æ§‹æ–‡ãƒã‚§ãƒƒã‚¯**
   - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®æ­£ç¢ºæ€§ï¼ˆuser.department, user.jobTitleç­‰ï¼‰
   - æ¼”ç®—å­ã®æ­£ã—ã„ä½¿ç”¨ï¼ˆ-eq, -contains, -and, -orï¼‰
   - å¼•ç”¨ç¬¦ã®é©åˆ‡ãªä½¿ç”¨

3. **å±æ€§å€¤ã®ç¢ºèª**
   - å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å®Ÿéš›ã®å±æ€§å€¤
   - å¤§æ–‡å­—å°æ–‡å­—ã®åŒºåˆ¥
   - ç©ºç™½æ–‡å­—ã®æœ‰ç„¡

4. **å‡¦ç†æ™‚é–“ã®è€ƒæ…®**
   - å‹•çš„æ›´æ–°ã«ã¯æ•°åˆ†ã€œæ•°æ™‚é–“ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚‹
   - å¤§è¦æ¨¡ãƒ†ãƒŠãƒ³ãƒˆã§ã¯æ›´ã«æ™‚é–“ã‚’è¦ã™ã‚‹
```

**è§£æ±ºç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**:

```powershell
function Diagnose-DynamicGroupIssues {
    param(
        [string]$GroupName,
        [string]$TestUserPrincipalName
    )
    
    Write-Host "=== å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—è¨ºæ–­ ===" -ForegroundColor Magenta
    
    try {
        # ã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±ã®ç¢ºèª
        $group = Get-MgGroup -Filter "displayName eq '$GroupName'"
        if (-not $group) {
            Write-Error "ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $GroupName"
            return
        }
        
        Write-Host "`nã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±:" -ForegroundColor Green
        Write-Host "  åå‰: $($group.DisplayName)" -ForegroundColor White
        Write-Host "  ID: $($group.Id)" -ForegroundColor White
        Write-Host "  ã‚°ãƒ«ãƒ¼ãƒ—ã‚¿ã‚¤ãƒ—: $($group.GroupTypes -join ', ')" -ForegroundColor White
        Write-Host "  å‹•çš„ãƒ«ãƒ¼ãƒ«: $($group.MembershipRule)" -ForegroundColor Yellow
        Write-Host "  å‡¦ç†çŠ¶æ…‹: $($group.MembershipRuleProcessingState)" -ForegroundColor White
        
        # ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å±æ€§ç¢ºèª
        if ($TestUserPrincipalName) {
            $testUser = Get-MgUser -Filter "userPrincipalName eq '$TestUserPrincipalName'" -Property "id,userPrincipalName,department,jobTitle,extensionAttribute1,extensionAttribute2,userType,employeeType,createdDateTime"
            
            Write-Host "`nãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§:" -ForegroundColor Green
            $testUser | Select-Object userPrincipalName, department, jobTitle, extensionAttribute1, extensionAttribute2, userType, employeeType, createdDateTime | Format-List
            
            # ç¾åœ¨ã®ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ç¢ºèª
            $isMember = Get-MgGroupMember -GroupId $group.Id | Where-Object { $_.Id -eq $testUser.Id }
            Write-Host "ç¾åœ¨ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—: $(if($isMember) {'ãƒ¡ãƒ³ãƒãƒ¼'} else {'éãƒ¡ãƒ³ãƒãƒ¼'})" -ForegroundColor $(if($isMember) {'Green'} else {'Red'})
        }
        
        # å‡¦ç†çŠ¶æ³ã®ç¢ºèª
        $processingState = $group.MembershipRuleProcessingState
        if ($processingState -eq "Paused") {
            Write-Warning "å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—å‡¦ç†ãŒåœæ­¢ã—ã¦ã„ã¾ã™"
            Write-Host "è§£æ±ºç­–: Update-MgGroup -GroupId $($group.Id) -MembershipRuleProcessingState 'On'" -ForegroundColor Cyan
        }
        
        # ä¸€èˆ¬çš„ãªå•é¡Œã®ç¢ºèª
        Write-Host "`nğŸ“‹ ä¸€èˆ¬çš„ãªå•é¡Œãƒã‚§ãƒƒã‚¯:" -ForegroundColor Yellow
        
        # Microsoft 365 A3/A5 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¢ºèª
        $tenantInfo = Get-MgOrganization
        Write-Host "  âœ“ ãƒ†ãƒŠãƒ³ãƒˆç¢ºèªå®Œäº†" -ForegroundColor Green
        
        # ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼æ•°ç¢ºèª
        $memberCount = (Get-MgGroupMember -GroupId $group.Id).Count
        Write-Host "  ç¾åœ¨ã®ãƒ¡ãƒ³ãƒãƒ¼æ•°: $memberCount å" -ForegroundColor White
        
        if ($memberCount -eq 0) {
            Write-Warning "    ãƒ¡ãƒ³ãƒãƒ¼ãŒ0åã§ã™ã€‚ãƒ«ãƒ¼ãƒ«æ¡ä»¶ã‚’æº€ãŸã™ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™"
        }
        
    } catch {
        Write-Error "è¨ºæ–­ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ: $($_.Exception.Message)"
    }
}

# ä½¿ç”¨ä¾‹
# Diagnose-DynamicGroupIssues -GroupName "Grade1-Students" -TestUserPrincipalName "s001@school.edu.jp"
```

#### å•é¡Œ2: School Data Sync é€£æºã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: SDS CSVãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒ»åŒæœŸå¤±æ•—

**è§£æ±ºæ–¹æ³•**:

```markdown
ğŸ”§ SDS ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**ãƒ‡ãƒ¼ã‚¿å½¢å¼ãƒã‚§ãƒƒã‚¯**:
- CSVæ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°: UTF-8 (BOMä»˜ã)
- æ”¹è¡Œã‚³ãƒ¼ãƒ‰: Windows (CRLF)
- å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ¬ æãƒã‚§ãƒƒã‚¯
- å¤–éƒ¨ã‚­ãƒ¼é–¢ä¿‚ã®æ•´åˆæ€§ç¢ºèª

**ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³**:
1. é‡è¤‡ã™ã‚‹ SIS ID
2. ç„¡åŠ¹ãªæ–‡å­—ï¼ˆç‰¹æ®Šè¨˜å·ã€çµµæ–‡å­—ï¼‰
3. ä¸æ­£ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼
4. å‚ç…§æ•´åˆæ€§ã‚¨ãƒ©ãƒ¼ï¼ˆå­˜åœ¨ã—ãªã„School SIS IDã®å‚ç…§ç­‰ï¼‰
```

**CSVãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**:

```powershell
function Validate-SDSData {
    param(
        [string]$SDSDataPath,
        [switch]$FixIssues
    )
    
    Write-Host "=== SDS ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼é–‹å§‹ ===" -ForegroundColor Magenta
    
    $validationResults = @{
        IsValid = $true
        Issues = @()
        FixedIssues = @()
    }
    
    try {
        $sdsFiles = @{
            School = "$SDSDataPath\School.csv"
            Teacher = "$SDSDataPath\Teacher.csv"  
            Student = "$SDSDataPath\Student.csv"
            Section = "$SDSDataPath\Section.csv"
            StudentEnrollment = "$SDSDataPath\StudentEnrollment.csv"
        }
        
        # ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
        foreach ($fileType in $sdsFiles.Keys) {
            $filePath = $sdsFiles[$fileType]
            if (-not (Test-Path $filePath)) {
                $validationResults.IsValid = $false
                $validationResults.Issues += "ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $filePath"
            }
        }
        
        if (-not $validationResults.IsValid) {
            return $validationResults
        }
        
        # School.csv æ¤œè¨¼
        Write-Host "School.csv æ¤œè¨¼ä¸­..." -ForegroundColor Yellow
        $schools = Import-Csv $sdsFiles.School -Encoding UTF8
        $schoolIds = $schools.'SIS ID'
        
        # é‡è¤‡ãƒã‚§ãƒƒã‚¯
        $duplicateSchools = $schoolIds | Group-Object | Where-Object { $_.Count -gt 1 }
        if ($duplicateSchools) {
            $validationResults.IsValid = $false
            $validationResults.Issues += "School.csv: é‡è¤‡ã™ã‚‹SIS ID - $($duplicateSchools.Name -join ', ')"
        }
        
        # Student.csv æ¤œè¨¼
        Write-Host "Student.csv æ¤œè¨¼ä¸­..." -ForegroundColor Yellow
        $students = Import-Csv $sdsFiles.Student -Encoding UTF8
        
        # å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
        foreach ($student in $students) {
            if ([string]::IsNullOrWhiteSpace($student.'SIS ID')) {
                $validationResults.Issues += "Student.csv: SIS IDãŒç©ºç™½ã®è¡ŒãŒã‚ã‚Šã¾ã™"
            }
            
            if ([string]::IsNullOrWhiteSpace($student.Username)) {
                $validationResults.Issues += "Student.csv: UsernameãŒç©ºç™½ã®è¡ŒãŒã‚ã‚Šã¾ã™ (SIS ID: $($student.'SIS ID'))"
            }
            
            # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ãƒã‚§ãƒƒã‚¯
            if ($student.Username -and $student.Username -notmatch '^[^@]+@[^@]+\.[^@]+) {
                $validationResults.Issues += "Student.csv: ç„¡åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ - $($student.Username)"
                
                if ($FixIssues) {
                    # ç°¡æ˜“ä¿®æ­£ä¾‹ï¼ˆå®Ÿéš›ã®è¦ä»¶ã«å¿œã˜ã¦èª¿æ•´ï¼‰
                    $fixedEmail = "$($student.'SIS ID')@school.edu.jp"
                    $student.Username = $fixedEmail
                    $validationResults.FixedIssues += "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ä¿®æ­£: $($student.'SIS ID') â†’ $fixedEmail"
                }
            }
            
            # å­¦æ ¡å‚ç…§æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
            if ($student.'School SIS ID' -notin $schoolIds) {
                $validationResults.IsValid = $false
                $validationResults.Issues += "Student.csv: å­˜åœ¨ã—ãªã„School SIS ID - $($student.'School SIS ID')"
            }
        }
        
        # Teacher.csv æ¤œè¨¼
        Write-Host "Teacher.csv æ¤œè¨¼ä¸­..." -ForegroundColor Yellow
        $teachers = Import-Csv $sdsFiles.Teacher -Encoding UTF8
        
        foreach ($teacher in $teachers) {
            if ($teacher.'School SIS ID' -notin $schoolIds) {
                $validationResults.IsValid = $false
                $validationResults.Issues += "Teacher.csv: å­˜åœ¨ã—ãªã„School SIS ID - $($teacher.'School SIS ID')"
            }
        }
        
        # Section.csv æ¤œè¨¼
        Write-Host "Section.csv æ¤œè¨¼ä¸­..." -ForegroundColor Yellow
        $sections = Import-Csv $sdsFiles.Section -Encoding UTF8
        
        foreach ($section in $sections) {
            if ($section.'School SIS ID' -notin $schoolIds) {
                $validationResults.IsValid = $false
                $validationResults.Issues += "Section.csv: å­˜åœ¨ã—ãªã„School SIS ID - $($section.'School SIS ID')"
            }
        }
        
        # StudentEnrollment.csv æ¤œè¨¼
        Write-Host "StudentEnrollment.csv æ¤œè¨¼ä¸­..." -ForegroundColor Yellow
        $enrollments = Import-Csv $sdsFiles.StudentEnrollment -Encoding UTF8
        $studentIds = $students.'SIS ID'
        $sectionIds = $sections.'SIS ID'
        
        foreach ($enrollment in $enrollments) {
            if ($enrollment.'SIS ID' -notin $studentIds) {
                $validationResults.IsValid = $false
                $validationResults.Issues += "StudentEnrollment.csv: å­˜åœ¨ã—ãªã„Student SIS ID - $($enrollment.'SIS ID')"
            }
            
            if ($enrollment.'Section SIS ID' -notin $sectionIds) {
                $validationResults.IsValid = $false
                $validationResults.Issues += "StudentEnrollment.csv: å­˜åœ¨ã—ãªã„Section SIS ID - $($enrollment.'Section SIS ID')"
            }
        }
        
        # ä¿®æ­£ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
        if ($FixIssues -and $validationResults.FixedIssues.Count -gt 0) {
            $students | Export-Csv "$SDSDataPath\Student_Fixed.csv" -Encoding UTF8 -NoTypeInformation
            Write-Host "ä¿®æ­£ã•ã‚ŒãŸStudent.csvã‚’ä¿å­˜ã—ã¾ã—ãŸ: Student_Fixed.csv" -ForegroundColor Green
        }
        
        # æ¤œè¨¼çµæœã‚µãƒãƒªãƒ¼
        Write-Host "`n=== SDS ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼çµæœ ===" -ForegroundColor Magenta
        Write-Host "æ¤œè¨¼çŠ¶æ…‹: $(if($validationResults.IsValid) {'âœ… æ­£å¸¸'} else {'âŒ å•é¡Œã‚ã‚Š'})" -ForegroundColor $(if($validationResults.IsValid) {'Green'} else {'Red'})
        Write-Host "å•é¡Œæ•°: $($validationResults.Issues.Count)" -ForegroundColor $(if($validationResults.Issues.Count -eq 0) {'Green'} else {'Red'})
        Write-Host "ä¿®æ­£æ•°: $($validationResults.FixedIssues.Count)" -ForegroundColor Green
        
        if ($validationResults.Issues.Count -gt 0) {
            Write-Host "`nå•é¡Œè©³ç´°:" -ForegroundColor Red
            $validationResults.Issues | ForEach-Object { Write-Host "  - $_" -ForegroundColor Red }
        }
        
        return $validationResults
        
    } catch {
        Write-Error "SDS ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼å¤±æ•—: $($_.Exception.Message)"
        $validationResults.IsValid = $false
        return $validationResults
    }
}
```

#### å•é¡Œ3: å¤§è¦æ¨¡ã‚°ãƒ«ãƒ¼ãƒ—ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ

**ç—‡çŠ¶**: ãƒ¡ãƒ³ãƒãƒ¼æ•°ã®å¤šã„ã‚°ãƒ«ãƒ¼ãƒ—ã§æ“ä½œãŒé…ã„ãƒ»ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**è§£æ±ºç­–**:

```powershell
function Optimize-LargeGroupOperations {
    param(
        [string]$GroupId,
        [int]$BatchSize = 20,
        [int]$DelayBetweenBatches = 5
    )
    
    Write-Host "å¤§è¦æ¨¡ã‚°ãƒ«ãƒ¼ãƒ—æœ€é©åŒ–å‡¦ç†é–‹å§‹..." -ForegroundColor Cyan
    
    try {
        # ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã®æ®µéšçš„å–å¾—
        $allMembers = @()
        $skip = 0
        
        do {
            $batch = Get-MgGroupMember -GroupId $GroupId -Top $BatchSize -Skip $skip
            $allMembers += $batch
            $skip += $BatchSize
            
            Write-Progress -Activity "ãƒ¡ãƒ³ãƒãƒ¼å–å¾—ä¸­" -Status "$($allMembers.Count) åå‡¦ç†æ¸ˆã¿" -PercentComplete -1
            
            if ($batch.Count -eq $BatchSize) {
                Start-Sleep -Seconds $DelayBetweenBatches
            }
        } while ($batch.Count -eq $BatchSize)
        
        Write-Progress -Activity "ãƒ¡ãƒ³ãƒãƒ¼å–å¾—ä¸­" -Completed
        Write-Host "âœ… ãƒ¡ãƒ³ãƒãƒ¼å–å¾—å®Œäº†: $($allMembers.Count) å" -ForegroundColor Green
        
        return $allMembers
        
    } catch {
        Write-Error "å¤§è¦æ¨¡ã‚°ãƒ«ãƒ¼ãƒ—æ“ä½œå¤±æ•—: $($_.Exception.Message)"
    }
}
```

---

## âœ… å­¦ç¿’æˆæœã®ç¢ºèª

### ç¿’å¾—ã‚¹ã‚­ãƒ«ãƒã‚§ãƒƒã‚¯

ã“ã®ç¯€ã‚’å®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®é …ç›®ã«ã¤ã„ã¦å®Ÿéš›ã«æ“ä½œã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

#### åŸºæœ¬ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†

- [ ] **ã‚°ãƒ«ãƒ¼ãƒ—ç¨®åˆ¥ã®ç†è§£**: Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã€é…å¸ƒã‚°ãƒ«ãƒ¼ãƒ—ã®ç‰¹å¾´ã¨ä½¿ã„åˆ†ã‘
- [ ] **é™çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ**: ç›®çš„ã«å¿œã˜ãŸé©åˆ‡ãªã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã¨è¨­å®š
- [ ] **ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»æ¨©é™è¨­å®š
- [ ] **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½¿ç”¨ã—ãŸé©åˆ‡ãªæ¨©é™ç®¡ç†

#### å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†

- [ ] **å‹•çš„ãƒ«ãƒ¼ãƒ«è¨­è¨ˆ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ã«åŸºã¥ãåŠ¹æœçš„ãªãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ«ãƒ¼ãƒ«ä½œæˆ
- [ ] **ãƒ«ãƒ¼ãƒ«æ¤œè¨¼**: ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã®å‹•çš„ãƒ«ãƒ¼ãƒ«å‹•ä½œç¢ºèª
- [ ] **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ã®å•é¡Œè¨ºæ–­ã¨è§£æ±º
- [ ] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: å¤§è¦æ¨¡ç’°å¢ƒã§ã®åŠ¹ç‡çš„ãªã‚°ãƒ«ãƒ¼ãƒ—é‹ç”¨

#### æ•™è‚²æ©Ÿé–¢ç‰¹æœ‰ã®ç®¡ç†

- [ ] **çµ„ç¹”æ§‹é€ å¯¾å¿œ**: å­¦æ ¡ã®éšå±¤æ§‹é€ ã«é©ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆ
- [ ] **å¹´æ¬¡æ›´æ–°è‡ªå‹•åŒ–**: æ–°å¹´åº¦å¯¾å¿œã®åŒ…æ‹¬çš„ãªè‡ªå‹•å‡¦ç†
- [ ] **SDSé€£æº**: School Data Sync ã‚’æ´»ç”¨ã—ãŸã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- [ ] **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ**: æ•™è‚²æ©Ÿé–¢ã®è¦ä»¶ã«é©ã—ãŸã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

### å®Ÿè·µèª²é¡Œ: ç·åˆã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†

å®Ÿéš›ã®æ•™è‚²æ©Ÿé–¢é‹å–¶ã‚’æƒ³å®šã—ãŸåŒ…æ‹¬çš„ãªèª²é¡Œã«å–ã‚Šçµ„ã‚“ã§ãã ã•ã„ï¼š

```markdown
ğŸ¯ ç·åˆèª²é¡Œ: é«˜ç­‰å­¦æ ¡Microsoft 365ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰

## èƒŒæ™¯
å…¨æ ¡ç”Ÿå¾’1,200åã€æ•™è·å“¡80åã®çœŒç«‹é«˜ç­‰å­¦æ ¡ã§ã€Microsoft 365ã‚’å…¨é¢å°å…¥ã€‚
åŠ¹ç‡çš„ã§å®‰å…¨ãªã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆãƒ»æ§‹ç¯‰ã‚’æ‹…å½“ã—ã¾ã™ã€‚

## è¦ä»¶
**çµ„ç¹”æ§‹é€ **:
- 3å­¦å¹´ Ã— 8ã‚¯ãƒ©ã‚¹ï¼ˆå„ã‚¯ãƒ©ã‚¹50åï¼‰
- æ•™ç§‘ï¼šå›½èªã€æ•°å­¦ã€è‹±èªã€ç†ç§‘ã€ç¤¾ä¼šã€èŠ¸è¡“ã€ä½“è‚²ã€æƒ…å ±
- éƒ¨æ´»å‹•ï¼š20éƒ¨æ´»ï¼ˆæ–‡åŒ–éƒ¨12ã€é‹å‹•éƒ¨8ï¼‰
- ç®¡ç†éƒ¨é–€ï¼šæ•™å‹™éƒ¨ã€ç”Ÿå¾’æŒ‡å°éƒ¨ã€é€²è·¯æŒ‡å°éƒ¨ã€äº‹å‹™éƒ¨

**ç®¡ç†è¦ä»¶**:
- å¹´æ¬¡æ›´æ–°ã®å®Œå…¨è‡ªå‹•åŒ–
- å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ™ãƒ«åˆ¥ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- éƒ¨æ´»å‹•ãƒ»å§”å“¡ä¼šã®æŸ”è»Ÿãªç®¡ç†
- ä¿è­·è€…ã¨ã®é€£æºæ©Ÿèƒ½

## å®Ÿæ–½å†…å®¹

### 1. è¨­è¨ˆãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ120åˆ†ï¼‰
- ã‚°ãƒ«ãƒ¼ãƒ—éšå±¤æ§‹é€ ã®è¨­è¨ˆ
- å‘½åè¦å‰‡ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ
- å‹•çš„ãƒ«ãƒ¼ãƒ«è¨­è¨ˆï¼ˆå­¦å¹´ãƒ»ã‚¯ãƒ©ã‚¹ãƒ»æ•™ç§‘ãƒ»éƒ¨æ´»å‹•ï¼‰
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼è¨­è¨ˆ
- å¹´æ¬¡æ›´æ–°ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

### 2. å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ180åˆ†ï¼‰
- åŸºæœ¬ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ ã®ä½œæˆ
- å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ«ãƒ¼ãƒ«ã®å®Ÿè£…
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã®é©ç”¨
- å¹´æ¬¡æ›´æ–°ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é–‹ç™º
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œæ¤œè¨¼

### 3. é‹ç”¨ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ60åˆ†ï¼‰
- é‹ç”¨æ‰‹é †æ›¸ã®ä½œæˆ
- å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¨­å®š
- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ã®ä½œæˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–è¨­å®š

## æˆæœç‰©
1. **è¨­è¨ˆæ›¸**ï¼šã‚°ãƒ«ãƒ¼ãƒ—éšå±¤å›³ã€ãƒ«ãƒ¼ãƒ«ä»•æ§˜æ›¸ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼
2. **å®Ÿè£…ç‰©**ï¼šPowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€å¼ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
3. **é‹ç”¨æ–‡æ›¸**ï¼šæ“ä½œæ‰‹é †æ›¸ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨ˆç”»ã€ç·Šæ€¥æ™‚å¯¾å¿œæ‰‹é †
4. **æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ**ï¼šãƒ†ã‚¹ãƒˆçµæœã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æã€æ”¹å–„ææ¡ˆ

## è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆ
- å®Ÿç”¨æ€§ï¼šå®Ÿéš›ã®å­¦æ ¡é‹å–¶ã§ä½¿ç”¨ã§ãã‚‹è¨­è¨ˆã‹
- åŠ¹ç‡æ€§ï¼šé‹ç”¨è² è·ã®è»½æ¸›ãŒå®Ÿç¾ã•ã‚Œã¦ã„ã‚‹ã‹
- å®‰å…¨æ€§ï¼šé©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹ã‹
- æ‹¡å¼µæ€§ï¼šå°†æ¥ã®å¤‰æ›´ãƒ»æ‹¡å¼µã«å¯¾å¿œã§ãã‚‹ã‹
- ä¿å®ˆæ€§ï¼šç¶™ç¶šçš„ãªé‹ç”¨ãƒ»æ”¹å–„ãŒå¯èƒ½ã‹
```

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã“ã®ç¯€ã‚’å®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®å­¦ç¿’ã«é€²ã‚€ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ï¼š

### æ¨å¥¨å­¦ç¿’ãƒ‘ã‚¹

1. **[3.4 ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ã¨æ¨©é™](04-roles-permissions.md)**
   - ã‚°ãƒ«ãƒ¼ãƒ—ãƒ™ãƒ¼ã‚¹ã®æ¨©é™ç®¡ç†ã®è©³ç´°
   - ã‚«ã‚¹ã‚¿ãƒ ãƒ­ãƒ¼ãƒ«è¨­è¨ˆã¨æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹

<!-- 2. **[ç¬¬4ç« : ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç®¡ç†](../04-license-management/)** -->
   - ã‚°ãƒ«ãƒ¼ãƒ—ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å‰²ã‚Šå½“ã¦
   - ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æˆ¦ç•¥

<!-- 3. **[ç¬¬5ç« : ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹](../05-security-compliance/)** -->
   - é«˜åº¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆ
   - ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¦ä»¶ã¨ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒªã‚·ãƒ¼

<!-- 4. **[ç¬¬6ç« : ãƒ‡ãƒã‚¤ã‚¹ç®¡ç†](../06-device-management/)** -->
   - ãƒ‡ãƒã‚¤ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹
   - Intune ã¨ã®é€£æºã«ã‚ˆã‚‹ãƒ‡ãƒã‚¤ã‚¹ç®¡ç†

### ç™ºå±•å­¦ç¿’

- **Microsoft Graph API**: ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ãªã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†
- **Azure Logic Apps**: ã‚°ãƒ«ãƒ¼ãƒ—ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã®è‡ªå‹•åŒ–
- **Power Platform**: ãƒ­ãƒ¼ã‚³ãƒ¼ãƒ‰/ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã§ã®ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã‚¢ãƒ—ãƒªé–‹ç™º
- **Microsoft Purview**: é«˜åº¦ãªã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã¨ã‚¬ãƒãƒŠãƒ³ã‚¹

### å°‚é–€è³‡æ ¼

- **Microsoft 365 Certified: Administrator Expert**
- **Microsoft 365 Certified: Security Administrator Associate**
- **Microsoft Entra ID Identity and Access Administrator (SC-300)**

---

## ğŸ“š å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

### Microsoftå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **Microsoft 365 ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¨®é¡ã«ã¤ã„ã¦** - å„ã‚°ãƒ«ãƒ¼ãƒ—ã‚¿ã‚¤ãƒ—ã®ç‰¹å¾´ã¨ç”¨é€”ã®è©³ç´°
- **Microsoft 365 ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¨®é¡ã‚’æ¯”è¼ƒã™ã‚‹** - ç®¡ç†è€…å‘ã‘ã®ã‚°ãƒ«ãƒ¼ãƒ—æ¯”è¼ƒã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- **Microsoft Graph API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** - ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ãªã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†
- **Microsoft Entra ID å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—** - å‹•çš„ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ«ãƒ¼ãƒ«ã®è©³ç´°ä»•æ§˜

### æ•™è‚²æ©Ÿé–¢ç‰¹åŒ–ãƒªã‚½ãƒ¼ã‚¹

- **Microsoft 365 Education** - æ•™è‚²æ©Ÿé–¢å‘ã‘ã®åŒ…æ‹¬çš„ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰
- **School Data Sync (SDS)** - æ ¡å‹™æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã¨Microsoftè£½å“ã‚’é€£æºã™ã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«
- **Teams for Education** - æ•™è‚²æ©Ÿé–¢å‘ã‘Teamsè¨­å®šã¨ã‚¯ãƒ©ã‚¹ç®¡ç†
- **Education Insights** - å­¦ç¿’åˆ†æã¨æ•™è‚²ãƒ‡ãƒ¼ã‚¿æ´»ç”¨

### å®Ÿç”¨ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

<!-- **ã‚°ãƒ«ãƒ¼ãƒ—è¨­è¨ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**:
- [çµ„ç¹”æ§‹é€ ãƒãƒƒãƒ”ãƒ³ã‚°ã‚·ãƒ¼ãƒˆ](../../appendices/templates/group-structure-template.xlsx)
- [å‹•çš„ãƒ«ãƒ¼ãƒ«è¨­è¨ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](../../appendices/templates/dynamic-rules-template.csv)
- [å¹´æ¬¡æ›´æ–°è¨ˆç”»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](../../appendices/templates/annual-update-plan.xlsx)

**PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆé›†**:
- [ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](../../appendices/powershell-commands.md#ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†)
- [å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ](../../appendices/scripts/dynamic-groups.ps1)
- [å¹´æ¬¡æ›´æ–°è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](../../appendices/scripts/annual-update.ps1)

**é‹ç”¨ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**:
- [ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](../../appendices/checklists/group-creation-checklist.md)
- [å¹´æ¬¡æ›´æ–°ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](../../appendices/checklists/annual-update-checklist.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](../../appendices/checklists/security-checklist.md) -->

### ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ»ã‚µãƒãƒ¼ãƒˆ

- **Microsoft Tech Community - Education**
  - æ•™è‚²æ©Ÿé–¢ã®ITç®¡ç†è€…ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£
  - ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®å…±æœ‰ã¨Q&A

- **Microsoft Education Partner Network**
  - æ•™è‚²æ©Ÿé–¢å‘ã‘å°‚é–€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼
  - å°å…¥æ”¯æ´ã¨ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°

- **GitHub - Microsoft Graph PowerShell**
  - æœ€æ–°ã®PowerShellãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
  - ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã‚‹æ‹¡å¼µæ©Ÿèƒ½

---

## ğŸ’¡ å®Ÿé‹ç”¨ã§ã®æˆåŠŸãƒã‚¤ãƒ³ãƒˆ

### ç¶™ç¶šçš„æ”¹å–„ã®ãŸã‚ã®æŒ‡æ¨™

```markdown
ğŸ“Š KPIï¼ˆé‡è¦æ¥­ç¸¾æŒ‡æ¨™ï¼‰

**åŠ¹ç‡æ€§æŒ‡æ¨™**:
- ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ä½œæ¥­æ™‚é–“ã®å‰Šæ¸›ç‡ï¼ˆç›®æ¨™ï¼š70%ä»¥ä¸Šï¼‰
- å¹´æ¬¡æ›´æ–°è‡ªå‹•åŒ–ç‡ï¼ˆç›®æ¨™ï¼š90%ä»¥ä¸Šï¼‰
- æ‰‹å‹•ä»‹å…¥ãŒå¿…è¦ãªä¾‹å¤–å‡¦ç†ä»¶æ•°ï¼ˆç›®æ¨™ï¼šå…¨ä½“ã®5%ä»¥ä¸‹ï¼‰

**æ­£ç¢ºæ€§æŒ‡æ¨™**:
- ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®æ­£ç¢ºæ€§ï¼ˆç›®æ¨™ï¼š99%ä»¥ä¸Šï¼‰
- ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®èª¤è¨­å®šä»¶æ•°ï¼ˆç›®æ¨™ï¼š0ä»¶ï¼‰
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿç‡ï¼ˆç›®æ¨™ï¼šå¹´é–“0ä»¶ï¼‰

**åˆ©ç”¨æº€è¶³åº¦æŒ‡æ¨™**:
- æ•™è·å“¡ã®ä½¿ã„ã‚„ã™ã•è©•ä¾¡ï¼ˆç›®æ¨™ï¼š4.0/5.0ä»¥ä¸Šï¼‰
- å­¦ç”Ÿã®ã‚¢ã‚¯ã‚»ã‚¹æ€§è©•ä¾¡ï¼ˆç›®æ¨™ï¼š4.0/5.0ä»¥ä¸Šï¼‰
- ITç®¡ç†è² è·è»½æ¸›å®Ÿæ„Ÿï¼ˆç›®æ¨™ï¼š80%ä»¥ä¸Šï¼‰

**ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§æŒ‡æ¨™**:
- ã‚°ãƒ«ãƒ¼ãƒ—æ•°ã®é©æ­£æ€§ï¼ˆè‚¥å¤§åŒ–é˜²æ­¢ï¼‰
- éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ«ãƒ¼ãƒ—å‰²åˆï¼ˆç›®æ¨™ï¼š5%ä»¥ä¸‹ï¼‰
- å¹³å‡ã‚°ãƒ«ãƒ¼ãƒ—ã‚µã‚¤ã‚ºã®é©æ­£æ€§
```

### é•·æœŸé‹ç”¨ã§ã®æ³¨æ„ç‚¹

- **å®šæœŸçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼**: å››åŠæœŸã”ã¨ã®ã‚°ãƒ«ãƒ¼ãƒ—æ§‹é€ è¦‹ç›´ã—
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»**: å¹´æ¬¡ã§ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ç·ç‚¹æ¤œ
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: ç¶™ç¶šçš„ãªåˆ©ä¾¿æ€§æ”¹å–„
- **æ–°æ©Ÿèƒ½å¯¾å¿œ**: Microsoft 365ã®æ©Ÿèƒ½æ›´æ–°ã¸ã®é©å¿œ
- **ç½å®³å¾©æ—§è¨ˆç”»**: ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©æ—§æ‰‹é †

---

*ğŸ“… æœ€çµ‚æ›´æ–°: 2025å¹´6æœˆ1æ—¥*  
*âœï¸ æ›´æ–°è€…: Microsoft 365 ãƒãƒ³ãƒ‰ãƒ–ãƒƒã‚¯ç·¨é›†ãƒãƒ¼ãƒ *  
*ğŸ“– å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³: Microsoft 365 Education (2025å¹´6æœˆç‰ˆ) / Microsoft Graph PowerShell SDK v2.0+*